celduin_trade_category = {
	upgrade_market = {
		icon = GFX_decision_upgrade_market
		fire_only_once = yes
		ai_will_do = { #ASAP
			factor = 10
		}
		days_mission_timeout = 100
		is_good = yes
		#days_remove = var:FROM.market_upgrade_time
		state_target = yes
		on_map_mode = map_only
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		cancel_trigger = { ##upgrade gets canceled if conquered
			NOT = { controls_state = FROM }
		}
		allowed = { always = no }
		available = { hidden_trigger = { always = no } }
		cancel_effect = {
			FROM = { clr_state_flag = constructing_market }
			subtract_from_variable = { market_upgrading_cost = global.market_upgrade_cost }
		}
		timeout_effect = {
			FROM = {
				add_building_construction = {
					type = market
					level = 1
					instant_build = yes
				}
				custom_effect_tooltip = resets_prosperity
				set_variable = { prosperity = 0 }
			}
			FROM = { clr_state_flag = constructing_market }
			subtract_from_variable = { market_upgrading_cost = global.market_upgrade_cost }
			random_other_country = { ##gain prosperity on their market from shipping tax
				limit = {
					has_idea = DOR_shipping_tax
					can_trade_with_ROOT = yes		
				}
				random_controlled_state = {
					limit = {
						market > 0
						check_variable = { prosperity < 100 }
					}
					add_5_prosperity = yes
				}
			}
		}
	}
	upgrade_market_short = {
		icon = GFX_decision_upgrade_market
		fire_only_once = yes
		ai_will_do = { #ASAP
			factor = 10
		}
		days_mission_timeout = 75
		is_good = yes
		#days_remove = var:FROM.market_upgrade_time
		state_target = yes
		on_map_mode = map_only
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		cancel_trigger = { ##upgrade gets canceled if conquered
			NOT = { controls_state = FROM }
		}
		allowed = { always = no }
		available = { hidden_trigger = { always = no } }
		cancel_effect = {
			FROM = { clr_state_flag = constructing_market }
			subtract_from_variable = { market_upgrading_cost = global.market_upgrade_cost }
		}
		timeout_effect = {
			FROM = {
				add_building_construction = {
					type = market
					level = 1
					instant_build = yes
				}
				custom_effect_tooltip = resets_prosperity
				set_variable = { prosperity = 0 }
			}
			FROM = { clr_state_flag = constructing_market }
			subtract_from_variable = { market_upgrading_cost = global.market_upgrade_cost }
			random_other_country = { ##gain prosperity on their market from shipping tax
				limit = {
					has_idea = DOR_shipping_tax
					can_trade_with_ROOT = yes		
				}
				random_controlled_state = {
					limit = {
						market > 0
						check_variable = { prosperity < 100 }
					}
					add_5_prosperity = yes
				}
			}
		}
	}

	@luxury_cost = 999
	@luxury_cost_negative = -1000
	@wine_decision_days = 100
	@luxury_cost_buffed = 2499
	@luxury_cost_buffed_negative = -2000
	
	auto_renew_luxury = {
		visible = { NOT = { has_country_flag = renew_luxury_decisions } }
		complete_effect = { set_country_flag = renew_luxury_decisions }
	}
	stop_auto_renew_luxury = {
		ai_will_do = { #ai should not auto renew
			factor = 1
		}
		visible = { has_country_flag = renew_luxury_decisions }
		complete_effect = { clr_country_flag = renew_luxury_decisions }
	}
	
	#############SPEND WINE
	wine_for_winelords = {
		icon = GFX_decision_winelords
		ai_will_do = {
			factor = 0
		}
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_campaign_of_cordiality has_power_balance = { id = DOR_election_power_balance } }
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		modifier = {
			power_balance_daily = 0.001
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_stability
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	@weeklyStab = 0.007
	wine_for_stability = {
		icon = GFX_decision_generic_stability
		ai_will_do = {
			factor = 1
			modifier = {
				has_stability < 0.75
				factor = 2
			}
			modifier = {
				has_stability < 0.5
				factor = 10
			}
			modifier = { #don't do if enough stability
				has_stability > 0.95
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		modifier = {
			stability_factor = 0.1
			#stability_weekly = @weeklyStab
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_stability
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}

	wine_for_war_support = {
		icon = GFX_decision_generic_war_support
		ai_will_do = {
			factor = 1
			modifier = {
				has_war_support < 0.75
				OR = {
					has_war = yes
					has_government = melkorite
					has_government = conquest
				}
				factor = 2
			}
			modifier = {
				has_war_support < 0.5
				OR = {
					has_war = yes
					is_evil = yes
				}
				factor = 10
			}
			modifier = { #peaceful people don't really care
				has_war = no
				is_good = yes
				factor = 0
			}
			modifier = { #don't do if enough stability
				has_war_support > 0.95
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		days_remove = @wine_decision_days
		modifier = {
			war_support_factor = 0.1
			#war_support_weekly = @weeklyStab
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_war_support
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}

	wine_for_consumer_goods = {
		icon = GFX_decision_generic_consumer_goods
		ai_will_do = {
			factor = 2
			modifier = { #don't do if not enough factories to likely make a difference
				num_of_factories < 15
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		modifier = {
			consumer_goods_factor = -0.1
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_consumer_goods
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	wine_for_morale = {
		icon = GFX_decision_generic_military
		ai_will_do = {
			factor = 1
			modifier = { #more likely if outmatched
				enemies_strength_ratio > 1
				factor = 2
			}
			modifier = { #more likely if outmatched
				enemies_strength_ratio > 1.25
				factor = 2
			}
			modifier = { #more likely if losing ground
				any_owned_state = { NOT = { is_controlled_by = ROOT } }
				factor = 3
			}
			modifier = { #no reason if at peace
				has_war = no
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		modifier = {
			army_morale_factor = 0.25
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_morale
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	wine_for_diplomacy = {
		icon = GFX_generic_befriend_decision
		ai_will_do = {
			factor = 0.25
			modifier = { #you don't need diplomacy!
				OR = {
					is_subject = yes
					AND = {
						has_war = yes
						is_in_faction = yes
					}
				}
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		modifier = {
			improve_relations_maintain_cost_factor = -0.75
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_diplomacy
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	wine_for_ideology_drift = {
		icon = GFX_decision_eng_blackshirt_speech
		ai_will_do = {
			factor = 0.25
			modifier = { #you don't need diplomacy!
				OR = {
					is_subject = yes
					AND = {
						has_war = yes
						is_in_faction = yes
					}
				}
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost }
		}
		custom_cost_text = wine_decision_cost
		days_remove = @wine_decision_days
		visible = { NOT = { has_completed_focus = DOR_host_lavish_galas } } #unlocks stronger version
		modifier = {
			drift_defence_factor = -0.25
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost } }
						activate_decision = wine_for_ideology_drift
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}

	buffed_wine_for_stability = {
		name = wine_for_stability
		icon = GFX_decision_generic_stability
		ai_will_do = {
			factor = 1
			modifier = {
				has_stability < 0.75
				factor = 2
			}
			modifier = {
				has_stability < 0.5
				factor = 10
			}
			modifier = { #don't do if enough stability
				has_stability > 0.95
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		days_remove = @wine_decision_days
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		modifier = {
			stability_factor = 0.2
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_stability
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}

	buffed_wine_for_war_support = {
		name = wine_for_war_support
		icon = GFX_decision_generic_war_support
		ai_will_do = {
			factor = 1
			modifier = {
				has_war_support < 0.75
				OR = {
					has_war = yes
					has_government = melkorite
					has_government = conquest
				}
				factor = 2
			}
			modifier = {
				has_war_support < 0.5
				OR = {
					has_war = yes
					is_evil = yes
				}
				factor = 10
			}
			modifier = { #peaceful people don't really care
				has_war = no
				is_good = yes
				factor = 0
			}
			modifier = { #don't do if enough stability
				has_war_support > 0.95
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		days_remove = @wine_decision_days
		modifier = {
			war_support_factor = 0.2
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_war_support
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}

	buffed_wine_for_consumer_goods = {
		name = wine_for_consumer_goods
		icon = GFX_decision_generic_consumer_goods
		ai_will_do = {
			factor = 2
			modifier = { #don't do if not enough factories to likely make a difference
				num_of_factories < 15
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		days_remove = @wine_decision_days
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		modifier = {
			consumer_goods_factor = -0.2
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_consumer_goods
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	buffed_wine_for_morale = {
		name = wine_for_morale
		icon = GFX_decision_generic_military
		ai_will_do = {
			factor = 1
			modifier = { #more likely if outmatched
				enemies_strength_ratio > 1
				factor = 2
			}
			modifier = { #more likely if outmatched
				enemies_strength_ratio > 1.25
				factor = 2
			}
			modifier = { #more likely if losing ground
				any_owned_state = { NOT = { is_controlled_by = ROOT } }
				factor = 3
			}
			modifier = { #no reason if at peace
				has_war = no
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		days_remove = @wine_decision_days
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		modifier = {
			army_morale_factor = 0.5
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_morale
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	buffed_wine_for_diplomacy = {
		name = wine_for_diplomacy
		icon = GFX_generic_befriend_decision
		ai_will_do = {
			factor = 0.25
			modifier = { #you don't need diplomacy!
				OR = {
					is_subject = yes
					AND = {
						has_war = yes
						is_in_faction = yes
					}
				}
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		days_remove = @wine_decision_days
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		modifier = {
			improve_relations_maintain_cost_factor = -1.5
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_diplomacy
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
	
	buffed_wine_for_ideology_drift = {
		name = wine_for_ideology_drift
		icon = GFX_decision_eng_blackshirt_speech
		ai_will_do = {
			factor = 0.25
			modifier = { #you don't need diplomacy!
				OR = {
					is_subject = yes
					AND = {
						has_war = yes
						is_in_faction = yes
					}
				}
				factor = 0
			}
		}
		custom_cost_trigger = {
			has_equipment = { wine_equipment > @luxury_cost_buffed }
		}
		custom_cost_text = wine_decision_cost_buffed
		days_remove = @wine_decision_days
		allowed = { original_tag = DOR }
		visible = { has_completed_focus = DOR_host_lavish_galas } #unlocks stronger version
		modifier = {
			drift_defence_factor = -0.5
		}
		complete_effect = { #cost
			hidden_effect = {
				add_equipment_to_stockpile = { type = wine_equipment amount = @luxury_cost_buffed_negative }
			}
		}
		remove_effect = {
			hidden_effect = { #renews if possible
				if = { #try to renew
					limit = { has_country_flag = renew_luxury_decisions }
					if = { #renew if can afford
						limit = { has_equipment = { wine_equipment > @luxury_cost_buffed } }
						activate_decision = wine_for_ideology_drift
					}
					else = { #let the player know they can't renew
						news_event = rfr_news.79
					}
				}
			}
		}
	}
}

colonisation_category = {
	uprising_in_colony = {
		icon = GFX_decision_revolt
		days_mission_timeout = 100
		is_good = no
		allowed = { always = no }
		state_target = yes
		available = {
			owns_state = FROM
		}
		complete_effect = {
			FROM = {
				add_resistance_target = {
					amount = -100
					tooltip = crushed_colonial_incursion
				}
				clr_state_flag = ongoing_incursion
			}
		}
		timeout_effect = {
			custom_effect_tooltip = destroy_colony_tooltip
			FROM = {
				owner = {
					if = { limit = { original_tag = WLD }
						recycle_colony_uprising = yes
					}
				}
				clr_state_flag = ongoing_incursion
				clr_country_flag = already_colonising
			}
		}
	}
	
	dominion_over_middle_earth = { ##complete your world conquest
		icon = GFX_decision_generic_nationalism
		ai_will_do = {
			factor = 1
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } }
		visible = { num_of_controlled_states > 100 }
		available = {
			all_other_country = { OR = { original_tag = FOR original_tag = WLD } }
		}
		complete_effect = {
			every_state = {
				limit = {
					NOT = { is_controlled_by = ROOT }
				}
				transfer_state_to = ROOT
			}
		}
	}
	
	MOR_settle_wilderness = {
		icon = GFX_decision_infiltrate_state
		ai_will_do = {
			base = 0 #I only want them annexing old dagorlad
			modifier = {
				OR = {
					FROM = {
						OR = {
							state = 119 #brown lands
							state = 120 #undeeps
							state = 121 #dagorlad
							state = 123 #emen muil
							state = 124 #noman lands
							state = 333 #nindalf
							state = 334 #Dead marshes
							state = 335 #ashkirir
							state = 336 #tumcelon
						}
					}
					#they can go ham in late game, though
					date > 3022.1.1 
					AND = {
						date > 3020.1.1
						has_war_with_major = no
					}
				}
				add = 10
			}
		}
		allowed = { original_tag = MOR }
		visible = { has_completed_focus = MOR_the_eye_looks_west }
		custom_cost_text = MOR_settle_wilderness_cost
		custom_cost_trigger = { has_manpower > var:dagorlad_settlement_cost }
		days_remove = 7
		state_target = yes
		target_array = WLD:owned_states
		complete_effect = { #cost
			hidden_effect = {
				set_temp_variable = { MPcost = dagorlad_settlement_cost }
				multiply_temp_variable = { MPcost = -1 }
				add_manpower = MPcost
			}
		}
		cancel_trigger = {
			FROM = { NOT = { is_owned_by = WLD } }
		}
		target_trigger = {
			FROM = {
				is_owned_by = WLD
				any_neighbor_state = { is_core_of = ROOT is_controlled_by = ROOT }
			}
		}
		remove_effect = {
			FROM = {
				transfer_state_to = ROOT
				add_core_of = ROOT
				remove_core_of = WLD
				add_manpower = 100000
				add_colony_start_victory_points = yes
				add_colony_finished_victory_points = yes
				hidden_effect = { clear_undeveloped_colony_resources = yes }
			}
			add_named_threat = { 
				threat = 1
				name = MOR_dagorlad_tension_tooltip
			}
			#add_to_variable = { dagorlad_settlement_cost = dagorlad_settlement_cost_increase }
		}
	}
	begin_colonisation = {
		icon = GFX_decision_settle_territory
		fire_only_once = no
		ai_will_do = {
			factor = 0
			modifier = {
				num_of_civilian_factories_available_for_projects > 3
				add = 1
			}
			modifier = {
				has_war = yes
				factor = 0
			}
			modifier = { #guide the colonisation path
				OR = {
					AND = { #east bight
						FROM = { state = 94 }
						ROOT = { OR = { tag = GLD tag = WOD } }
					}
					AND = { #upper mirvan
						FROM = { region = 18 }
						ROOT = { OR = { tag = MIR } }
					}
					AND = { #lower mirvan
						FROM = { region = 83 }
						ROOT = { OR = { tag = MIR } }
					}
				}
				factor = 2
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		days_remove = 105
		state_target = yes
		target_array = WLD:owned_states
		#targets = { 94 109 111 119 120 121 122  124 307 333 334 335  336 } #123 emyn muil
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		visible = {
			NOT = { has_country_flag = already_colonising }
			has_tech = colony0
		}
			
		available = {
			NOT = { has_country_flag = already_colonising }
			num_of_civilian_factories_available_for_projects > 1
			has_manpower > 15000
		}
		target_trigger = {
			FROM = {
				is_owned_by = WLD
				any_neighbor_state = { is_core_of = ROOT is_controlled_by = ROOT  }
			}
		}
		cancel_trigger = { ##upgrade gets canceled if conquered
			NOT = {
				FROM = {
					is_owned_by = WLD
					any_neighbor_state = { is_owned_by = ROOT }
				}
			}
		}
		cancel_effect = { clr_country_flag = already_colonising }
		modifier = {
			civilian_factory_use = 2
			weekly_manpower = -1000
		}
		complete_effect = {
			set_country_flag = already_colonising
		}
		remove_effect = {
			FROM = {
				transfer_state_to = ROOT
				set_variable = { base_population = state_population } #so it can reset if revolt
				add_manpower = 15000
				add_colony_start_victory_points = yes
				set_variable = { integration_cost = state_population_k }
				divide_variable = { integration_cost = 3 }
				add_claim_by = ROOT
			}
			ROOT = { set_variable = { integration_cost = FROM.integration_cost } }
		}
	}
		
	annex_colony = {
		icon = GFX_decision_settle_territory
		fire_only_once = yes
		cost = var:integration_cost
		ai_will_do = {
			factor = 10
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:core_states
		#targets = { 94 109 111 119 120 121 122 123 124 307 333 334 335 336 }
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		available = {
			custom_trigger_tooltip = { tooltip = colony_cost_scales_with_pop always = yes }
			FROM = {
				infrastructure > 0
				compliance > 70
				state_population_k > 150
			}
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		remove_effect = {
			FROM = {
				add_core_of = ROOT
				remove_core_of = WLD
				upgrade_state_category = yes
				add_colony_finished_victory_points = yes
				clear_undeveloped_colony_resources = yes
				remove_dynamic_modifier = { modifier = wilderness_state }
			}
			clr_country_flag = already_colonising
		}
	}

	encourage_colonial_settlement = {
		icon = GFX_decision_generic_nationalism
		cost = 50
		days_remove = 100
		allowed = { NOT = { OR = { tag = FOR original_tag = WLD } } }
		visible = { any_controlled_state = { is_core_of = WLD } }
		modifier = {
			colony_growth_monthly_factor = 0.25
		}
	}
	@resourcePerDecision = 8
	@equipmentPerProspect = 49
	@equipmentPerProspectNegative = -50
	@prospectingRepeatable = yes #repeatable cause arrays & in case of colony destruction
	colony_food = { #increase food in a colony that can produce food
		icon = GFX_decision_food
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 1
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:food_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = food
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.food_state_array = THIS.id }
				add_to_array = { value = THIS.id array = WLD.developed_food_state_array }
			}
		}
	}
	colony_cloth = { #increase cloth in a colony that can produce cloth
		icon = GFX_decision_cloth
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:cloth_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = cloth
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.cloth_state_array = THIS.id }
				add_to_array = { value = THIS.id array = WLD.developed_cloth_state_array }
			}
		}
	}
	colony_wood = { #increase wood in a colony that can produce wood
		icon = GFX_decision_wood
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 5
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:wood_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = wood
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.wood_state_array = THIS.id }
				add_to_array = { value = THIS.id array = WLD.developed_wood_state_array }
			}
		}
	}
	colony_iron = { #increase iron in a colony that can produce iron
		icon = GFX_decision_steel
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 10
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:iron_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = iron
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.iron_state_array = THIS.id }
				add_to_array = { value = THIS.id array = WLD.developed_iron_state_array }
			}
		}
	}
	colony_mounts = { #increase mounts in a colony that can produce mounts
		icon = GFX_decision_mounts
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 5
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:mounts_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = mounts
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.mounts_state_array = THIS.id }
				add_to_array = { value = THIS.id array = WLD.developed_mounts_state_array }
			}
		}
	}
	#################################################TIER2
	colony_food2 = { #increase food in a colony that can produce food
		icon = GFX_decision_food
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 0
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:developed_food_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = food
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.developed_food_state_array = THIS.id }
				#add_to_array = { value = THIS.id array = WLD.developed_food_state_array }
			}
		}
	}
	colony_cloth2 = { #increase cloth in a colony that can produce cloth
		icon = GFX_decision_cloth
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 1
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:developed_cloth_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = cloth
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.developed_cloth_state_array = THIS.id }
				#add_to_array = { value = THIS.id array = WLD.developed_cloth_state_array }
			}
		}
	}
	colony_wood2 = { #increase wood in a colony that can produce wood
		icon = GFX_decision_wood
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 5
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:developed_wood_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = wood
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.developed_wood_state_array = THIS.id }
				#add_to_array = { value = THIS.id array = WLD.developed_wood_state_array }
			}
		}
	}
	colony_iron2 = { #increase iron in a colony that can produce iron
		icon = GFX_decision_steel
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 5
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:developed_iron_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = iron
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.developed_iron_state_array = THIS.id }
				#add_to_array = { value = THIS.id array = WLD.developed_iron_state_array }
			}
		}
	}
	colony_mounts2 = { #increase mounts in a colony that can produce mounts
		icon = GFX_decision_mounts
		fire_only_once = @prospectingRepeatable
		cost = 50
		ai_will_do = {
			factor = 1
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		custom_cost_trigger = { has_equipment = { engineering_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_prospect_decision_cost
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		state_target = yes
		target_array = WLD:developed_mounts_state_array
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
				is_core_of  = WLD
			}
		}
		available = { controls_state = FROM }
		available = { controls_state = FROM } #FROM = { NOT = { has_state_flag = already_prospecting } } }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = engineering_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resource = {
					type = mounts
					amount = @resourcePerDecision
				}
				clr_state_flag = already_prospecting
				remove_from_array = { WLD.developed_mounts_state_array = THIS.id }
				#add_to_array = { value = THIS.id array = WLD.developed_mounts_state_array }
			}
		}
	}
	
	
	colony_suppression = { #compliance
		icon = GFX_decision_generic_arrest
		on_map_mode = decision_view_only
		fire_only_once = yes
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
			modifier = {
				FROM = { compliance > 70 }
				factor = 0
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		custom_cost_trigger = { has_equipment = { suppression_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_suppression_decision_cost
		state_target = yes
		target_array = WLD:core_states
		#targets = { 94 109 111 119 120 121 122  124 307 333 334 335  336 } #123 emyn muil
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		available = { controls_state = FROM }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = suppression_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_compliance = 25
			}
		}
	}
	colony_signals = { #resistance
		icon = GFX_decision_SWI_expand_covert_operations
		on_map_mode = decision_view_only
		fire_only_once = yes
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
			modifier = {
				FROM = { resistance < 35 }
				factor = 0
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		custom_cost_trigger = { has_equipment = { signals_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_signals_decision_cost
		state_target = yes
		target_array = WLD:core_states
		#targets = { 94 109 111 119 120 121 122  124 307 333 334 335  336 } #123 emyn muil
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		available = { controls_state = FROM }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = signals_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_resistance_target = -25
			}
		}
	}
	colony_medical = { #population
		icon = GFX_decision_ITA_italian_east_africa
		on_map_mode = decision_view_only
		fire_only_once = yes
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
			modifier = {
				FROM = { resistance < 35 }
				factor = 0
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		custom_cost_trigger = { has_equipment = { medical_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_medical_decision_cost
		state_target = yes
		target_array = WLD:core_states
		#targets = { 94 109 111 119 120 121 122  124 307 333 334 335  336 } #123 emyn muil
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		available = { controls_state = FROM }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = medical_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_manpower = 25000
			}
		}
	}
	colony_maintenance = { #state category
		icon = GFX_decision_generic_industry
		on_map_mode = decision_view_only
		fire_only_once = yes
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		custom_cost_trigger = { has_equipment = { maintenance_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_maintenance_decision_cost
		state_target = yes
		target_array = WLD:core_states
		#targets = { 94 109 111 119 120 121 122  124 307 333 334 335  336 } #123 emyn muil
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_owned_by = ROOT
			}
		}
		available = { controls_state = FROM }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = maintenance_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				upgrade_state_category = yes
			}
		}
	}
	colony_motorized = { #supply node
		icon = GFX_decision_generic_trade
		on_map_mode = decision_view_only
		fire_only_once = yes
		ai_will_do = {
			factor = 2
			modifier = {
				has_war = yes
				factor = 0
			}
		}
		allowed = { NOT = { original_tag = FOR original_tag = WLD } } #wastelands can't colonise
		custom_cost_trigger = { has_equipment = { motorized_equipment > @equipmentPerProspect } }
		custom_cost_text = colony_motorized_decision_cost
		state_target = yes
		targets = { 94 109 111 119 120 121 122 307 335 336 } #only the states with VPs
		highlight_states = {
			highlight_state_targets = {
				state = FROM
			}
			highlight_color_while_active = 3
			highlight_color_before_active = 2
		}
		target_trigger = {
			FROM = {
				is_core_of = WLD
				is_owned_by = ROOT
			}
		}
		available = { controls_state = FROM }
		complete_effect = {
			hidden_effect = {
				add_equipment_to_stockpile = { type = motorized_equipment amount = @equipmentPerProspectNegative }
			}
		}
		remove_effect = {
			FROM = {
				add_colony_supply_node = yes
			}
		}
	}

	
	# DEBUG_colony_growth = {
		# visible = { is_debug = yes }
		# days_remove = 100
		# modifier = { colony_growth_monthly = 100000 }
	# }
}

rhovanion_influence_category = {
	DEBUG_100_RHOVAN_INFLUENCE = {
		visible = { is_debug = yes }
		complete_effect = {
			every_country = {
				limit = { is_rhovanion_tag = yes }
				set_variable = { influence@ROOT = 100 }
				custom_effect_tooltip = add_100_PREV_influence
			}
		}
	}
	rhovanion_influence_same_faction = {
		icon = GFX_decision_generic_political_discourse
		cost = 50
		fire_only_once = yes
		ai_will_do = {
			factor = 0
			modifier = { #don't spam, focus on one
				check_variable = { FROM.influence@ROOT > 5 }
				add = 5
			}
		}
		visible = {
			is_in_faction_with = FROM
			can_influence_rhovanion = yes
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				#Gain influence
				add_to_variable = { influence@ROOT = 25 }
				custom_effect_tooltip = add_25_PREV_influence
			}
		}
	}
	rhovanion_influence_subtract = {
		icon = GFX_decision_power_struggle
		custom_cost_text = rhovanion_30_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 0
		}
		visible = { #any other country has enoguh influence to matter
			can_influence_rhovanion = yes
			any_other_country = {
				check_variable = { FROM.influence@THIS > 0 }
			}
			NOT = { has_war_with = FROM }
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 30
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				#cost you
				subtract_from_variable = { influence@ROOT = 25 }
				#cost everyone else
				every_other_country = {
					limit = {
						check_variable = { PREV.influence@THIS > 0 }
						NOT = { tag = ROOT }
					}
					subtract_from_variable = { PREV.influence@THIS = 10 }
					custom_effect_tooltip = subtract_10_influence
				}
			}
		}
	}
	rhovanion_influence_ideology = {
		icon = GFX_decision_eng_propaganda_campaigns
		custom_cost_text = rhovanion_25_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 1
		}
		days_re_enable = 180
		visible = {
			can_influence_rhovanion = yes
			FROM = {
				NOT = { has_government = ROOT }
			}
			NOT = { has_war_with = FROM }
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 25
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 25 }
			}
			##uses this variable in the meta effect
			if = {
				limit = { is_rhunnic_tag = yes }
				set_variable = { tag_token = RUN }
			}
			else_if = {
				limit = { is_rhovanion_tag = yes }
				set_variable = { tag_token = RVN }
			}
			else_if = {
				limit = { original_tag = DAL }
				set_variable = { tag_token = DAL }
			}
			else_if = {
				limit = { original_tag = DOR }
				set_variable = { tag_token = DOR }
			}
			else_if = {
				limit = { original_tag = GLD }
				set_variable = { tag_token = GLD }
			}
			meta_effect = {
				text = {
					FROM = {
						add_timed_idea = {
							idea = [TAG_TOKEN]_[IDEOLOGY_TOKEN]_influence
							days = 180
						}
					}
				}
				IDEOLOGY_TOKEN = "[?current_party_ideology_group.GetTokenKey]"
				TAG_TOKEN = "[?tag_token.GetTag]"
			}
		}
	}
	rhovanion_influence_trade = {
		icon = GFX_decision_generic_trade
		custom_cost_text = rhovanion_25_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 0
			modifier = {
				original_tag = DOR
				add = 1
			}
			modifier = {
				has_government = isolationism
				add = 1
			}
		}
		fire_only_once = yes
		visible = {
			can_influence_rhovanion = yes
			FROM = {
				has_government = ROOT
			}
			NOT = { has_war_with = FROM }
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 25
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 25 }
				meta_effect = {
					text = {
						add_ideas = [TAG_TOKEN]_trade_influence
					}
					TAG_TOKEN = "[ROOT.GetTag]"
				}
			}
		}
	}
	rhovanion_influence_guarantee = {
		icon = GFX_decision_rhovanion_influence
		custom_cost_text = rhovanion_25_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 0
		}
		fire_only_once = yes
		visible = {
			can_influence_rhovanion = yes
			FROM = {
				has_government = ROOT
				is_subject = no
				NOT = { is_in_faction_with = ROOT }
			}
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 25
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 25 }
				if = {
					limit = {
						NOT = { has_guaranteed = ROOT }
					}
					give_guarantee = ROOT
				}
				if = {
					limit = {
						NOT = { gives_military_access_to = ROOT }
					}
					give_military_access = ROOT
				}
			}
			if = {
				limit = {
					NOT = { has_guaranteed = FROM }
				}
				give_guarantee = FROM
			}
			if = {
				limit = {
					NOT = { gives_military_access_to = FROM }
				}
				give_military_access = FROM
			}
			if = {
				limit = {
					NOT = { has_non_aggression_pact_with = FROM }
				}
				diplomatic_relation = {
					country = FROM
					relation = non_aggression_pact
					active = yes
				}
			}
		}
	}
	rhovanion_influence_puppet = {
		icon = GFX_decision_rhovanion_influence
		custom_cost_text = rhovanion_100_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 10
		}
		fire_only_once = yes
		visible = {
			can_influence_rhovanion = yes
			FROM = {
				has_government = ROOT
				is_subject = no
			}
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 100
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 100 }
				hidden_effect = { news_event = { id = rfr_news.139 hours = 1 } }
			}
			set_autonomy = {
				target = FROM
				autonomy_state = autonomy_puppet
				end_wars = yes
				end_civil_wars = yes
			}
		}
	}
	rhovanion_influence_resource_rights = {
		icon = GFX_decision_eng_trade_unions_demand
		custom_cost_text = rhovanion_25_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 0
		}
		fire_only_once = yes
		allowed = { original_tag = DOR }
		visible = {
			has_subject = FROM
			has_completed_focus = DOR_procure_resources_for_our_economy
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 25
					}
				}
			}
			FROM = {
				meta_trigger = {
					text = {
						has_idea = [TAG_TOKEN]_trade_influence
					}
					TAG_TOKEN = "[ROOT.GetTag]"
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 25 }
				meta_effect = {
					text = {
						remove_ideas = [TAG_TOKEN]_trade_influence
					}
					TAG_TOKEN = "[ROOT.GetTag]"
				}
				hidden_effect = { news_event = { id = rfr_news.140 hours = 1 } }
			}
			every_state = {
				limit = { is_owned_by = FROM }
				FROM = {
					give_resource_rights = { receiver = ROOT state = PREV }
				}
			}
		}
	}
	rhovanion_influence_annex = { #non-DLC
		icon = GFX_decision_infiltrate_state
		custom_cost_text = rhovanion_150_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 1
		}
		fire_only_once = yes
		allowed = {
			has_subject_autonomy_feature = no
		}
		visible = {
			has_subject = FROM
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 150
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 150 }
			}
			annex_country = {
				target = FROM
				transfer_troops = yes
			}
		}
	}
	rhovanion_influence_autonomy = { #DLC
		icon = GFX_decision_infiltrate_state
		custom_cost_text = rhovanion_50_influence_cost
		custom_cost_trigger = { always = yes } #can't check FROM variables in custom cost trigger
		ai_will_do = {
			factor = 10
		}
		allowed = {
			has_subject_autonomy_feature = yes
		}
		visible = {
			has_subject = FROM
		}
		available = {
			hidden_trigger = {
				FROM = {
					check_variable = {
						var = influence@ROOT
						compare = greater_than_or_equals
						value = 50
					}
				}
			}
		}
		targets = { DRG HEH RIN RUS SEK SUN YST }
		targets_dynamic = yes
		
		complete_effect = {
			FROM = {
				subtract_from_variable = { influence@ROOT = 50 }
				add_autonomy_score = {
					value = -500
					localization = rhovanion_influence_autonomy
				}
			}
		}
	}
}
