# Scripted AI desire for peace actions.
# See documentation.info file for more detailed scripting information.

peace_ai_desires = {
	
	take_our_cores = {
        peace_action_type = { take_states }
        enable = {
            ROOT = { tag = ROOT.FROM } #We are negotiating for ourselves
            ROOT.FROM.FROM.FROM = { is_core_of = ROOT.FROM } #It is ours
        }
        ai_desire = 100
    }
	
	generic_influence_cutoff = {
        peace_action_type = { take_states }
        enable = {
            ROOT = { tag = ROOT.FROM } #We are negotiating for ourselves
            ROOT.FROM.FROM.FROM = { NOT = { is_core_of = ROOT.FROM } } #It is not ours
			ROOT.FROM.FROM.FROM = { 
				NOT = { is_claimed_by = ROOT.FROM } 
				pc_is_state_outside_influence_for_winner = ROOT.FROM
				#is_coastal = no
				NOT = {
					any_neighbor_state = {
						pc_is_state_claimed_by = ROOT.FROM
					}
				}
				NOT = {
					OR = {
						AND = {
							is_capital = yes
							is_coastal = yes
						}
					}
				}
			} #It is not claimed by us
        }
        ai_desire = -1000
    }

	true_evil_majors_on_a_mission = {
        peace_action_type = take_states
        enable = {
            ROOT = { 
				NOT = { tag = ISN }			#We aren't Isengard (special handling)
				is_major = yes				#We are big
				is_true_evil = yes			#We are the baddies
				tag = ROOT.FROM				#We are acting for ourselves
			}
        }

        ai_desire = 500
    }
	
	true_evil_puppet_desire = {
        peace_action_type = puppet
        enable = {
            ROOT = { 
				NOT = { tag = ISN }			#We aren't Isengard (special handling)
				is_major = yes				#We are big
				is_true_evil = yes			#We are the baddies
				tag = ROOT.FROM				#We are acting for ourselves
			}
        }

        ai_desire = -75
    }
	
	isengard_puppet_desire = {
		peace_action_type = puppet
		enable = {
			ROOT = {
				original_tag = ISN
			}
		}
		ai_desire = 125
	}
	
	isengard_feed_province_of_dunland_desire = {
		peace_action_type = take_states
		enable = {
			ROOT = {
				original_tag = ISN
			}
			ROOT.FROM = {
				tag = ISD
			}
			ROOT.FROM.FROM.FROM = {
				is_greater_enedwaith_core = yes
			}
		}
		ai_desire = 200
	}
	
	isengard_secure_imprtant_states_desire = { #Wants fangorn and the state bordering nan curunir
		peace_action_type = take_states
		enable = {
			ROOT = {
				original_tag = ISN
			}
			FROM.FROM.FROM = {
				OR = {
					state = 74 #fangorn
					any_neighbor_state = {
						state = 68 #nan curunir
					}
				}
			}
		}
		ai_desire = 200
	}
	
	true_evil_liberate_desire = {
        peace_action_type = liberate
        enable = {
            ROOT = { 
				NOT = { tag = ISN }			#We aren't Isengard (special handling)
				is_major = yes				#We are big
				is_true_evil = yes 			#We are the baddies
				tag = ROOT.FROM				#We are acting for ourselves
			}
			ROOT = { FROM = { THIS_and_PREV_same_ideology = no } }
        }

        ai_desire = -75
    }

    # Countries the ai should be more unlikely to release in a peace deal
    unlikely_countries = {
        peace_action_type = liberate
        enable = {
            FROM = {
                is_unlikely_country_tag = yes
            }
        }
        ai_desire = -85  # 85 percent lower desire
    }

    # Countries the ai should be more unlikely to puppet in a peace deal
    unlikely_countries_puppet = {
        peace_action_type = puppet
        enable = {
            FROM = {
                is_unlikely_country_tag = yes
            }
        }
        ai_desire = -50  # 50 percent lower desire (slightly more keen to puppet than to liberate)
    }

    # Force gov on true evil preferably
    freedom_force_government_on_true_evil = {
        peace_action_type = force_government
        enable = {
            ROOT = { has_government = freedom }
            ROOT.FROM = { is_true_evil = yes }
            ROOT.FROM.FROM.FROM = { NOT = { is_claimed_by = ROOT.FROM } }
        }
        ai_desire = 50
    }

    freedom_owner_does_not_have_core = {
        peace_action_type = { force_government puppet take_states }
        enable = {
            ROOT = { has_government = freedom }
            ROOT.FROM.FROM.FROM = { NOT = { is_core_of = ROOT.FROM } }
        }
        ai_desire = -50
    }

    other_owner_does_not_have_core = {
        peace_action_type = { force_government puppet take_states }
        enable = {
            ROOT = {
                NOT = { is_assertive = yes }
				NOT = {
					tag = ROOT.FROM
				}
            }
            ROOT.FROM.FROM.FROM = {
                NOT = { is_core_of = ROOT.FROM }
            }
        }
        ai_desire = -20
    }

    dont_grab_exclaves = {
        peace_action_type = take_states
        enable = {
            ROOT.FROM.FROM.FROM = {
                NOT = {
                    OR = {
                        is_claimed_by = ROOT.FROM
						any_neighbor_state = {
                            OR = {
                                is_owned_by = ROOT.FROM
                                pc_is_state_claimed_by = ROOT.FROM
                            }
                        }
                    }
                }
            }
        }
        ai_desire = -40
    }

    do_grab_stuff_near_us = {
        peace_action_type = take_states
        enable = {
            ROOT.FROM.FROM.FROM = {
                OR = {
                    any_neighbor_state = {
                        OR = {
                            is_owned_by = ROOT.FROM
                        }
                    }
                    is_claimed_by = ROOT.FROM
                }
            }
            ROOT = {
                tag = ROOT.FROM
            }
        }
        ai_desire = 10
    }

    leave_force_gov_at_will_to_allies = { #It is a bit hacky, but we need a preference here or we end up worse than where we started
        peace_action_type = force_government
        enable = {
            ROOT = { NOT = { has_government = freedom } }
            ROOT.FROM.FROM.FROM = {
                NOT = {
                    any_neighbor_state = {
                        OR = {
                            pc_is_state_claimed_by = ROOT.FROM
                            pc_is_state_claimed_by = ROOT
                        }
                    }
                }
            }
        }
        ai_desire = -80
    }

    generic_occupies_state = {
        peace_action_type = { take_states puppet liberate force_government }

        enable = {
            FROM.FROM.FROM = { NOT = { is_controlled_by = ROOT } }
        }
        ai_desire = -10
    }

    good_dont_liberate_the_wrong_ideology = {
        peace_action_type = liberate
        enable = {
            ROOT = { is_good = yes }
            ROOT.FROM = {
                is_evil = yes
            }
        }
        ai_desire = -200
    }

    dont_puppet_and_force_government = {
        peace_action_type = { puppet }

        enable = {
            FROM.FROM = { pc_is_forced_government_by = ROOT }
        }
        ai_desire = -200
    }

    dont_force_government_and_puppet = {
        peace_action_type = { force_government }

        enable = {
            FROM.FROM = { pc_is_puppeted_by = ROOT }
        }
        ai_desire = -200
    }

    conquest_dont_liberate_the_wrong_ideology = {
        peace_action_type = liberate
        enable = {
            ROOT = { has_government = conquest }
            ROOT.FROM = {
                NOT = {
                    OR = {
                        has_government = conquest
                        has_government = opportunism
                    }
                }
            }
        }
        ai_desire = -200
    }

    melkorite_dont_liberate = {
        peace_action_type = liberate
        enable = {
            ROOT = { has_government = melkorite }
        }
        ai_desire = -500
    }

    dont_force_government_or_puppet_on_non_core = {
        peace_action_type = { puppet force_government }
        enable = {
            ROOT.FROM.FROM.FROM = {
                NOT = { is_core_of = ROOT.FROM.FROM }
            }
        }

        ai_desire = -50
    }

    liberate_on_non_core = {
        peace_action_type = liberate
        enable = {
            ROOT = { has_government = freedom }
            ROOT.FROM.FROM.FROM = {
                NOT = { is_core_of = ROOT.FROM.FROM }
            }
        }

        ai_desire = 10
    }

    liberate_if_already_exists = {
        peace_action_type = liberate
        enable = {
            ROOT = { has_government = freedom }
            ROOT.FROM = {
                pc_is_liberated = yes
            }
            ROOT.FROM.FROM.FROM = {
                is_core_of = ROOT.FROM
            }
        }

        ai_desire = 100
    }

    minors_and_subjects_dont_liberate = {
        peace_action_type = { liberate take_states force_government puppet }
        enable = {
            ROOT = {
                NOT = { tag = ROOT.FROM }
            }
            ROOT = {
                OR = {
                    is_major = no
                    is_subject = yes
                }
            }
            ROOT.FROM.FROM.FROM = {
                NOT = {
                    OR = {
                        is_core_of = ROOT.FROM
                        is_claimed_by = ROOT.FROM
                    }
                }
            }
        }
        ai_desire = -90
    }

    isolationism_should_stick_to_claims = {
        peace_action_type = take_states
        enable = {
            ROOT = { has_government = isolationism }
            ROOT.FROM.FROM.FROM = {
                NOT = { is_claimed_by = ROOT.FROM }
                NOT = { is_core_of = ROOT.FROM }
            }
        }
        ai_desire = -50
    }

    wrong_ideology_faction_members_dont_force_gov = {
        peace_action_type = force_government
        enable = {
            ROOT = {
                NOT = { has_government = freedom }
                any_allied_country = {
                    is_faction_leader = yes
                    has_government = freedom
                }
            }
        }
        ai_desire = -200
    }
	
	avoid_forcing_gov_if_ally_has_core = {
        peace_action_type = force_government
        enable = {
            ROOT.FROM.FROM.FROM = {
				any_country_with_core = {
					exists = yes
					pc_is_on_same_side_as = ROOT
				}
			}
        }
        ai_desire = -200
    }

    force_gov_puppets = {
        peace_action_type = force_government
        enable = {
            ROOT = {
                has_government = freedom
                ROOT.FROM.FROM = {
                    NOT = { has_government = freedom }
                    is_subject = yes
                }
            }
        }
        ai_desire = 100
    }

    dont_resurrect_sauron = {
        peace_action_type = liberate
        enable = {
            ROOT.FROM = {
                original_tag = MOR
                has_government = Melkorite
            }
        }
        ai_desire = -1000
    }
	
    dont_resurrect_saruman = {
        peace_action_type = liberate
        enable = {
            ROOT.FROM = {
                original_tag = ISN
                is_evil = yes
            }
        }
        ai_desire = -100
    }

    dont_take_states_for_wrong_ideology_allies = {
        peace_action_type = take_states
        enable = {
            ROOT = {
                NOT = {
                    tag = ROOT.FROM
                }
            }
            ROOT.FROM = {
                NOT = { has_same_ideology = yes }
            }
        }
        ai_desire = -20
    }

    prefer_take_states_for_puppets_with_cores = {
        peace_action_type = take_states
        enable = {
            ROOT.FROM = {
                is_subject_of = ROOT
                has_civil_war = yes
            }
            ROOT.FROM.FROM.FROM = {
                is_core_of = ROOT.FROM
            }
        }
        ai_desire = 100
    }

    dont_force_government_for_puppets_with_cores = {
        peace_action_type = { force_government puppet }
        enable = {
            ROOT.FROM.FROM.FROM = {
                any_country_with_core = {
                    is_subject_of = ROOT
                    has_civil_war = yes
                }
            }
        }
        ai_desire = -100
    }

    # push countries to actually retake territory that has risen up against them
    retake_territory_from_independence_wars = {
        peace_action_type = { take_states }
        enable = {
            FROM.FROM = {
                has_war_with_wargoal_against = {
                  target = ROOT
                  type = independence_wargoal
                }

            }
        }
        ai_desire = 75
    }

    dont_change_gov_after_independence_wars = {
        peace_action_type = { force_government liberate puppet }
        enable = {
            FROM.FROM = {
                has_war_with_wargoal_against = {
                  target = ROOT
                  type = independence_wargoal
                }

            }
        }
        ai_desire = -75
    }
	
	return_puppet_cores = { #This simply has to be the highest priority.
		peace_action_type = take_states
		enable = {
			ROOT.FROM = {
				OR = {
					is_subject_of = ROOT
					pc_is_puppeted_by = ROOT
				}
			}
			ROOT.FROM.FROM.FROM = {
				is_core_of = ROOT.FROM
				NOT = { is_core_of = ROOT }
			}
		}
		ai_desire = 70 #Acceptable values
	}
	
	unite_greater_enedwaith_culture = {
        peace_action_type = { take_states }
		enable = {
			OR = {
				AND = {#Andrast
					ROOT.FROM = {
						is_andrast_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_andrast_state = yes
					}
				}
				AND = {#dunland
					ROOT.FROM = {
						is_dunland_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_dunland_state = yes
					}
				}
				AND = {#druwaith
					ROOT.FROM = {
						is_druwaith_iaur_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_druwaith_iaur_state = yes
					}
				}
				AND = { #enedwaith
					ROOT.FROM = {
						is_enedwaith_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_enedwaith_state = yes
					}
				}
				AND = { #eregion
					ROOT.FROM = {
						is_eregion_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_eregion_state = yes
					}
				}
				AND = { #white mountains
					ROOT.FROM = {
						is_white_mountains_tag = yes
						tag = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_white_mountains_state = yes
					}
				}
			}
		}
		ai_desire = 150
	}
	unite_greater_enedwaith_culture_for_puppet = {
        peace_action_type = { take_states }
		enable = {
			OR = {
				AND = {#Andrast
					ROOT.FROM = {
						is_andrast_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_andrast_state = yes
					}
				}
				AND = {#dunland
					ROOT.FROM = {
						is_dunland_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_dunland_state = yes
					}
				}
				AND = {#druwaith
					ROOT.FROM = {
						is_druwaith_iaur_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_druwaith_iaur_state = yes
					}
				}
				AND = { #enedwaith
					ROOT.FROM = {
						is_enedwaith_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_enedwaith_state = yes
					}
				}
				AND = { #eregion
					ROOT.FROM = {
						is_eregion_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_eregion_state = yes
					}
				}
				AND = { #white mountains
					ROOT.FROM = {
						is_white_mountains_tag = yes
						is_subject_of = ROOT
					}
					ROOT.FROM.FROM.FROM = {
						is_white_mountains_state = yes
					}
				}
			}
		}
		ai_desire = 50
	}
	annex_ancestral_enemy = {
        peace_action_type = { take_states }
        enable = {
            ROOT = {
				is_greater_enedwaith_tag = yes
				tag = ROOT.FROM #We are negotiating for ourselves
			}
            ROOT.FROM.FROM = { tag = var:ROOT.ancestral_enemy } #It belongs to ancestral enemy
        }
        ai_desire = 125
    }
	#############
	# Misc
	#############
	
	puppet_if_another_puppet_has_core = {
		peace_action_type = puppet
		enable = {
			ROOT.FROM.FROM.FROM = {
				NOT = {
					any_country_with_core = {
						is_subject_of = ROOT #Not a pc subject
					}
				}
				any_country_with_core = {
					pc_is_puppeted_by = ROOT #Is a puppet created in PC
				}
			}
		}
		ai_desire = 30
	}
	
	dont_liberate_if_we_could_puppet_or_owner_is_our_ideology = {
		peace_action_type = liberate
		enable = {
			ROOT.FROM.FROM.FROM = { 
				any_country_with_core = {
					OR = {
						pc_is_puppeted_by = ROOT 
						pc_is_forced_government_by = ROOT
						AND = {
							country_exists = THIS #Ie - has provinces already and isn't a new creation
							has_same_ideology = yes
						}
						is_in_faction_with = ROOT
					}
				}
			}
		}
		ai_desire = -30
	}
	
	dont_do_other_things_if_we_should_liberate = {
		peace_action_type = { take_states puppet force_government }
		enable = {
			ROOT.FROM.FROM.FROM = { 
				any_country_with_core = {
					pc_is_liberated = yes
				}
			}
		}
		ai_desire = -200 #This value has to be highly weighted to offset some other things
	}
	
	minors_dont_fragment_as_much = {
		peace_action_type = { puppet liberate }
		enable = {
			is_major = no
			ROOT.FROM.FROM = { pc_is_puppeted = yes }
			NOT = { ROOT.FROM.FROM = { pc_is_puppeted_by = ROOT } }
		}
		ai_desire = -100
	}
	
	majors_dont_fragment_as_much_less = {
		peace_action_type = { puppet liberate }
		enable = {
			is_major = yes
			ROOT.FROM.FROM = { 
				pc_is_puppeted = yes 
				NOT = { ROOT.FROM.FROM = { pc_is_puppeted_by = ROOT } }
			}
		}
		ai_desire = -50
	}
	
	minors_follow_your_leader_when_forcing_gov = {
		peace_action_type = force_government
		enable = {
			is_major = no
			ROOT.FROM.FROM = { pc_is_forced_government = no }
		}
		ai_desire = -100
	}
	
	continuous_force_gov_desire = {
        peace_action_type = { force_government }
        enable = {
            FROM.FROM = { pc_is_forced_government_by = ROOT }
        }
        ai_desire = 30
    }

    continuous_puppet = {
        peace_action_type = { puppet }
        enable = {
            FROM.FROM = { pc_is_puppeted_by = ROOT }
        }
        ai_desire = 30
    }
	
	leave_player_controlled_land_until_later_in_the_process = {
		peace_action_type = { take_states puppet force_government liberate }
		enable = {
			ROOT.FROM.FROM.FROM = { 
				controller = {
					is_ai = no
				}
			}
		}
		ai_desire = -10
	}
	
	minors_avoid_interfering_with_random_claims = {
		peace_action_type = { take_states }
		enable = {
			ROOT = { is_ai = yes }
			ROOT.FROM = { 
				tag = ROOT 
				is_major = no
			}
			ROOT.FROM.FROM.FROM = {
				NOT = { 
					OR = {
						is_claimed_by = ROOT 
						is_core_of = ROOT
					}
				}
			}
		}
		ai_desire = -80
	}
	
	dont_even_try_to_puppet_large_states = { ###Too messy
        peace_action_type = { puppet }

        enable = {
            ROOT.FROM.FROM = { check_variable = { num_owned_states > 30 } }
        }
        ai_desire = -200
    }


}




