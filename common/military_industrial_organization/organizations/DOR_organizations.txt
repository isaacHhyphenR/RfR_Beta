@pillarOfSocietyCostReduction = -1
@expandedMarketFundsGain = 0.25
@trustedEmployerBonus = -0.15
@equipForSupportArtillery = 12
@equipForArtillery = 36
@equipForInfantry = 100
@equipForIrregular = 80
@equipForSupport = 30
@infEquipForSupport = 10
@equipForTanks = 50
@manpowerForInfantry = 1000
@manpowerForArtillery = 500
@manpowerForSupportArtillery = 300
@manpowerForSupport = 500
@manpowerForTanks = 500

##############################################################################################################################
# CAVALRY HOUSES
##############################################################################################################################
DOR_house_vierling_MIO = {
	name = dorwinion_house_vierling
	icon = GFX_idea_dorwinion_house_vierling
	include = generic_medium_tank_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	visible = {
		FROM = { house_vierling_visible = yes }
	}
}
DOR_house_raudbarad_MIO = {
	name = dorwinion_house_raudbarad
	icon = GFX_idea_dorwinion_house_raudbarad
	include = generic_infantry_tank_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
}
DOR_house_barvadinian_MIO = {
	name = dorwinion_house_barvadinian
	icon = GFX_idea_dorwinion_house_barvadinian
	include = generic_mobile_tank_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = { mio_cat_eq_all_light_tank }
	research_categories = { mio_cat_tech_light_armor_and_modules }

	initial_trait = {
		name = generic_mio_initial_trait_fast_tanks_designer
		
		equipment_bonus = {
			armor_value = -0.05
			reliability = -0.05
			maximum_speed = 0.1
		}
		organization_modifier = {
			military_industrial_organization_research_bonus = 0.05
		}
	}
}


##############################################################################################################################
# NAVAL HOUSES
##############################################################################################################################
DOR_house_aldiana_MIO = {
	name = dorwinion_house_aldiana
	icon = GFX_idea_dorwinion_house_aldiana
	include = generic_escort_ship_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		screen_ship
		convoy_1
	}
	research_categories = {
		mio_cat_tech_all_screen_ship_and_modules
		tp_tech
	}
		
	tree_header_text = {
		text = mio_header_systems
		x = 1
	}
	tree_header_text = {
		text = mio_header_weapons
		x = 5
	}
	tree_header_text = {
		text = mio_header_convoys
		x = 8
	}
	##convoys
	trait = {
		token = generic_mio_trait_convoy_production
		name = generic_mio_trait_convoy_production
		icon = GFX_generic_mio_trait_icon_production_capacity
		
		position = { x=8 y=0 }

		limit_to_equipment_type = { convoys }
		production_bonus = {
			production_cost_factor = -0.07
		}
	}
	trait = {
		token = generic_mio_trait_swift_convoys
		name = generic_mio_trait_swift_convoys
		icon = GFX_generic_mio_trait_icon_maximum_speed

		position = { x=-1 y=1 }
		relative_position_id = generic_mio_trait_convoy_production
		
		any_parent = { generic_mio_trait_convoy_production }
		mutually_exclusive = { generic_mio_trait_defensive_convoys }

		limit_to_equipment_type = { convoys }
		equipment_bonus = {
			naval_speed = 0.1
			surface_visibility = -0.1
		}
	}
	trait = {
		token = generic_mio_trait_defensive_convoys
		name = generic_mio_trait_defensive_convoys
		icon = GFX_generic_mio_trait_icon_defense

		position = { x=1 y=1 }
		relative_position_id = generic_mio_trait_convoy_production
		
		any_parent = { generic_mio_trait_convoy_production }
		mutually_exclusive = { generic_mio_trait_swift_convoys }

		limit_to_equipment_type = { convoys }
		equipment_bonus = {
			max_strength = 0.2
		}
	}
	trait = {
		token = generic_mio_trait_boarding_parties
		name = generic_mio_trait_boarding_parties
		icon = GFX_generic_mio_trait_icon_lg_attack

		position = { x=0 y=1 }
		relative_position_id = generic_mio_trait_defensive_convoys
		
		any_parent = { generic_mio_trait_defensive_convoys }

		limit_to_equipment_type = { convoys }
		equipment_bonus = {
			lg_attack = 5
		}
	}
	trait = {
		token = generic_mio_trait_mass_produced_convoys
		name = generic_mio_trait_mass_produced_convoys
		icon = GFX_generic_mio_trait_icon_build_cost_ic

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_swift_convoys
		
		any_parent = { generic_mio_trait_swift_convoys generic_mio_trait_defensive_convoys }

		limit_to_equipment_type = { convoys }
		production_bonus = {
			production_cost_factor = -0.1
		}
	}
	trait = {
		token = generic_mio_trait_low_grade_wood
		name = generic_mio_trait_low_grade_wood
		icon = GFX_generic_mio_trait_icon_resources

		position = { x=0 y=1 }
		relative_position_id = generic_mio_trait_mass_produced_convoys
		
		any_parent = { generic_mio_trait_mass_produced_convoys }

		limit_to_equipment_type = { convoys }
		production_bonus = {
			production_resource_need_factor = -0.15
		}
		equipment_bonus = {
			max_strength = -0.05
		}
	}
}

DOR_house_blorchid_MIO = {
	name = dorwinion_house_blorchid
	icon = GFX_idea_dorwinion_house_blorchid
	include = generic_battle_line_ship_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		mio_cat_eq_all_cruiser
	}
	research_categories = {
		mio_cat_tech_all_cruiser_and_modules
	}
	
}

##############################################################################################################################
# INFANTRY HOUSES
##############################################################################################################################
DOR_house_ilian_MIO = {
	name = dorwinion_house_ilian
	icon = GFX_idea_dorwinion_house_ilian
	include = generic_infantry_equipment_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		infantry_equipment
		infantry_armor
	}
	research_categories = {
		infantry_weapons
		infantry_support_weapons
	}
}
DOR_house_garmeniana_MIO = {
	name = dorwinion_house_garmeniana
	icon = GFX_idea_dorwinion_house_garmeniana
	include = generic_support_equipment_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
}
DOR_house_galen_MIO = {
	name = dorwinion_house_galen
	icon = GFX_idea_dorwinion_house_galen
	include = generic_artillery_organization

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
}


##############################################################################################################################
# BAKING GUILD
##############################################################################################################################
DOR_baking_guild_MIO = {
	name = dorwinion_baking_guild
	icon = GFX_idea_dorwinion_baking_guild

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		motorized_equipment
	}
	research_categories = {
		motorized_equipment
	}
	
	
	tree_header_text = {
		text = mio_header_commercial
		x = 1
	}
	tree_header_text = {
		text = mio_header_motorized
		x = 4
	}

	initial_trait = {
		name = generic_mio_initial_trait_wagon_provisioner

		organization_modifier = {
			military_industrial_organization_research_bonus = 0.05
		}
		equipment_bonus = {
			fuel_capacity = 1
		}
	}

####################################################
#######################################################COMMERCIAL
####################################################
	trait = {
		token = dorwinion_trait_efficient_recipes
		name = dorwinion_trait_efficient_recipes
		icon = GFX_generic_mio_trait_icon_fuel_consumption

		position = { x=0 y=0 }
		
		mutually_exclusive = { dorwinion_trait_imperishable_recipes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_baking_guild_fuel = yes }
		}
	}
	trait = {
		token = dorwinion_trait_efficient_harvesting
		name = dorwinion_trait_efficient_harvesting
		icon = GFX_generic_mio_trait_icon_resources

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_efficient_recipes

		any_parent = { dorwinion_trait_efficient_recipes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_baking_guild_fuel_manpower = yes }
		}
	}
	trait = {
		token = dorwinion_trait_imperishable_recipes
		name = dorwinion_trait_imperishable_recipes
		icon = GFX_generic_mio_trait_icon_supply_consumption

		position = { x=2 y=0 }
		relative_position_id = dorwinion_trait_efficient_recipes
		
		mutually_exclusive = { dorwinion_trait_efficient_recipes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_baking_guild_supply = yes }
		}
	}
	trait = {
		token = dorwinion_trait_hardy_rations
		name = dorwinion_trait_hardy_rations
		icon = GFX_generic_mio_trait_icon_entrenchment

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_imperishable_recipes
		
		any_parent = { dorwinion_trait_imperishable_recipes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_baking_guild_supply_colony = yes }
		}
	}
	trait = {
		token = dorwinion_trait_innovation_of_artisans
		name = dorwinion_trait_innovation_of_artisans
		icon = GFX_generic_mio_trait_icon_book

		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_efficient_harvesting

		any_parent = { dorwinion_trait_efficient_harvesting dorwinion_trait_hardy_rations }
		
		on_complete = {
			FROM = {
				if = {
					limit = { has_country_flag = dorwinion_baking_guild_fuel_manpower }
					upgrade_to_dorwinion_baking_guild_fuel_manpower = yes
				}
				else = {
					upgrade_to_dorwinion_baking_guild_supply_colony_tech = yes
				}
			}
		}
	}
	#########FOCUS TRAITS
	trait = {
		token = dorwinion_trait_pillar_of_society
		name = dorwinion_trait_pillar_of_society
		icon = GFX_generic_mio_trait_icon_political

		position = { x=9 y=0 }
		
		available = { FROM = { has_completed_focus = DOR_pillars_of_society } }
		
		organization_modifier = {
			military_industrial_organization_industrial_manufacturer_assign_cost = @pillarOfSocietyCostReduction
		}
	}
	trait = {
		token = dorwinion_trait_expanded_market
		name = dorwinion_trait_expanded_market
		icon = GFX_generic_mio_trait_icon_money

		position = { x=9 y=1 }
		
		available = { FROM = { has_completed_focus = DOR_expand_citizenship_rights } }
		
		organization_modifier = {
			military_industrial_organization_funds_gain = @expandedMarketFundsGain
		}
	}
####################################################
#######################################################WAGONS
####################################################
	trait = {
		token = dorwinion_trait_merchant_caravans
		name = dorwinion_trait_merchant_caravans
		icon = GFX_generic_mio_trait_icon_money

		position = { x=2 y=0 }
		relative_position_id = dorwinion_trait_imperishable_recipes

		
		equipment_bonus = {
			supply_consumption = -0.1
		}
	}
	trait = {
		token = dorwinion_trait_built_for_tough_roads
		name = dorwinion_trait_built_for_tough_roads
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_merchant_caravans

		any_parent = { dorwinion_trait_merchant_caravans }
		
		equipment_bonus = {
			reliability = 0.15
		}
	}
	trait = {
		token = dorwinion_trait_as_long_as_any_goods_get_through
		name = dorwinion_trait_as_long_as_any_goods_get_through
		icon = GFX_generic_mio_trait_icon_build_cost_ic

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_built_for_tough_roads

		any_parent = { dorwinion_trait_built_for_tough_roads }
		
		equipment_bonus = {
			build_cost_ic = -0.05
		}
	}
}


##############################################################################################################################
# CARPENTRY GUILD
##############################################################################################################################
DOR_carpentry_guild_MIO = {
	name = dorwinion_carpentry_guild
	icon = GFX_idea_dorwinion_carpentry_guild

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		artillery_equipment
		#railway_gun_equipment
		mio_cat_eq_all_ship
	}
	research_categories = {
		artillery
		naval_equipment
	}
	
	
	tree_header_text = {
		text = mio_header_commercial
		x = 1
	}
	tree_header_text = {
		text = mio_header_bows
		x = 5
	}
	tree_header_text = {
		text = mio_header_ships
		x = 8
	}

	initial_trait = {
		name = carpenter

		organization_modifier = {
			military_industrial_organization_research_bonus = 0.05
		}
		production_bonus = {
			production_cost_factor = -0.05
		}
	}

####################################################
#######################################################COMMERCIAL
####################################################
	trait = {
		token = dorwinion_trait_better_tools
		name = dorwinion_trait_better_tools
		icon = GFX_generic_mio_trait_icon_entrenchment

		position = { x=1 y=0 }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_carpentry_guild_construction = yes }
		}
	}
	trait = {
		token = dorwinion_trait_elite_workers
		name = dorwinion_trait_elite_workers
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=-1 y=2 }
		relative_position_id = dorwinion_trait_better_tools

		any_parent = { dorwinion_trait_better_tools }
		mutually_exclusive = { dorwinion_trait_extensive_logistics }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_carpentry_guild_construction_factory = yes }
		}
	}
	trait = {
		token = dorwinion_trait_efficient_planning
		name = dorwinion_trait_efficient_planning
		icon = GFX_generic_mio_trait_icon_efficiency_gain

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_elite_workers
		
		any_parent = { dorwinion_trait_elite_workers }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_carpentry_guild_construction_factory_slots = yes }
		}
	}
	trait = {
		token = dorwinion_trait_extensive_logistics
		name = dorwinion_trait_extensive_logistics
		icon = GFX_generic_mio_trait_icon_supply_consumption

		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_better_tools
		
		any_parent = { dorwinion_trait_better_tools }
		mutually_exclusive = { dorwinion_trait_elite_workers }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_carpentry_guild_construction_infrastructure = yes }
		}
	}
	trait = {
		token = dorwinion_trait_innovation_of_artisans
		name = dorwinion_trait_innovation_of_artisans
		icon = GFX_generic_mio_trait_icon_book

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_extensive_logistics

		any_parent = { dorwinion_trait_extensive_logistics }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_carpentry_guild_construction_infrastructure_tech = yes  }
		}
	}
	#########FOCUS TRAITS
	trait = {
		token = dorwinion_trait_pillar_of_society
		name = dorwinion_trait_pillar_of_society
		icon = GFX_generic_mio_trait_icon_political

		position = { x=9 y=0 }
		
		available = { FROM = { has_completed_focus = DOR_pillars_of_society } }
		
		organization_modifier = {
			military_industrial_organization_industrial_manufacturer_assign_cost = @pillarOfSocietyCostReduction
		}
	}
	trait = {
		token = dorwinion_trait_expanded_market
		name = dorwinion_trait_expanded_market
		icon = GFX_generic_mio_trait_icon_money

		position = { x=9 y=1 }
		
		available = { FROM = { has_completed_focus = DOR_expand_citizenship_rights } }
		
		organization_modifier = {
			military_industrial_organization_funds_gain = @expandedMarketFundsGain
		}
	}
####################################################
#######################################################BOWS
####################################################
	trait = {
		token = generic_mio_trait_advanced_barrel_forging
		name = generic_mio_trait_advanced_barrel_forging
		icon = GFX_generic_mio_trait_icon_efficiency_gain

		position = { x=3 y=0 }
		relative_position_id = dorwinion_trait_better_tools
		
		limit_to_equipment_type = { artillery_equipment } #railway_gun_equipment }
		production_bonus = {
			production_efficiency_gain_factor = 0.05
		}
	}

	trait = {
		token = generic_mio_trait_lighter_and_cheaper
		name = generic_mio_trait_lighter_and_cheaper
		icon = GFX_generic_mio_department_icon_artillery_production

		position = { x=2 y=0 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging
		
		limit_to_equipment_type = { artillery_equipment } #railway_gun_equipment }
		equipment_bonus = {
			soft_attack = -0.02
			build_cost_ic = -0.03
		}
	}

	trait = {
		token = generic_mio_trait_gun_mass_production
		name = generic_mio_trait_gun_mass_production
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging

		all_parents = {	generic_mio_trait_advanced_barrel_forging }

		limit_to_equipment_type = { artillery_equipment } #railway_gun_equipment }
		production_bonus = {
			production_efficiency_gain_factor = 0.03
			production_efficiency_cap_factor = 0.03
		}

		organization_modifier = {
			military_industrial_organization_design_team_assign_cost = -0.15
		}
	}

	trait = {
		token = generic_mio_trait_simpler_models
		name = generic_mio_trait_simpler_models
		icon = GFX_generic_mio_trait_icon_ap_attack

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_lighter_and_cheaper

		all_parents = {	generic_mio_trait_lighter_and_cheaper }

		limit_to_equipment_type = { artillery_equipment } #railway_gun_equipment }
		equipment_bonus = {
			reliability = 0.07
			ap_attack = -0.07
		}

		organization_modifier = {
			military_industrial_organization_design_team_assign_cost = -0.15
		}
	}

	trait = {
		token = generic_mio_trait_light_weight_barrels
		name = generic_mio_trait_light_weight_barrels
		icon = GFX_generic_mio_trait_icon_breakthrough

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_gun_mass_production

		all_parents = {
			generic_mio_trait_simpler_models
			generic_mio_trait_gun_mass_production

		}

		limit_to_equipment_type = { artillery_equipment } #railway_gun_equipment }
		production_bonus = {
			production_cost_factor = -0.03
		}

		equipment_bonus = {
			breakthrough = 0.06
			defense = 0.1
		}
	}
####################################################
#######################################################SHIPS
####################################################
	trait = {
		token = generic_mio_trait_foam_fire_extinguishers
		name = generic_mio_trait_foam_fire_extinguishers
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=4 y=0 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging
		
		available = { FROM = { has_completed_focus = DOR_order_a_vast_fleet } }
		
		limit_to_equipment_type = { mio_cat_eq_all_ship }
		equipment_bonus = {
			reliability = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_bulkhead_shoring_procedure
		name = generic_mio_trait_bulkhead_shoring_procedure
		icon = GFX_generic_mio_department_icon_ship_capital_screen_armor

		position = { x=0 y=1 }
		relative_position_id = generic_mio_trait_foam_fire_extinguishers
		
		all_parents = { generic_mio_trait_foam_fire_extinguishers }
		
		limit_to_equipment_type = { mio_cat_eq_all_ship }
		equipment_bonus = {
			reliability = 0.01
			armor_value = 0.02
		}
	}

	trait = {
		token = generic_mio_trait_flooding_boundries
		name = generic_mio_trait_flooding_boundries
		icon = GFX_generic_mio_trait_icon_max_strength

		position = { x=0 y=1 }
		relative_position_id = generic_mio_trait_bulkhead_shoring_procedure
		
		all_parents = { generic_mio_trait_bulkhead_shoring_procedure }
		
		limit_to_equipment_type = { mio_cat_eq_all_ship }
		equipment_bonus = {
			max_strength = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_protected_pumps
		name = generic_mio_trait_protected_pumps
		icon = GFX_generic_mio_trait_icon_max_strength

		position = { x=0 y=1 }
		relative_position_id = generic_mio_trait_flooding_boundries
		
		all_parents = { generic_mio_trait_flooding_boundries }
		
		limit_to_equipment_type = { mio_cat_eq_all_ship }
		equipment_bonus = {
			max_strength = 0.05
		}
	}

	trait = {
		token = generic_mio_trait_high_powered_steering
		name = generic_mio_trait_high_powered_steering
		icon = GFX_generic_mio_department_icon_ship_capital_screen_armor

		position = { x=1 y=1 }
		relative_position_id = generic_mio_trait_bulkhead_shoring_procedure
		
		all_parents = { generic_mio_trait_bulkhead_shoring_procedure }
		
		limit_to_equipment_type = { mio_cat_eq_all_ship }
		equipment_bonus = {
			reliability = 0.01
			armor_value = 0.02
		}
	}
}

##############################################################################################################################
# SMITHING GUILD
##############################################################################################################################
DOR_smithing_guild_MIO = {
	name = dorwinion_smithing_guild
	icon = GFX_idea_dorwinion_smithing_guild

	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		infantry_equipment
		infantry_armor
	}
	research_categories = {
		infantry_tech
	}
	
	
	tree_header_text = {
		text = mio_header_commercial
		x = 1
	}
	tree_header_text = {
		text = mio_header_weapons_and_armor
		x = 6
	}

	initial_trait = {
		name = blacksmith

		organization_modifier = {
			military_industrial_organization_research_bonus = 0.05
		}
	}

####################################################
#######################################################COMMERCIAL
####################################################
	trait = {
		token = dorwinion_trait_better_tools
		name = dorwinion_trait_better_tools
		icon = GFX_generic_mio_trait_icon_entrenchment

		position = { x=1 y=0 }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_smithing_guild_efficiency = yes }
		}
	}
	trait = {
		token = dorwinion_trait_standardized_facilities
		name = dorwinion_trait_standardized_facilities
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=-1 y=2 }
		relative_position_id = dorwinion_trait_better_tools

		any_parent = { dorwinion_trait_better_tools }
		mutually_exclusive = { dorwinion_trait_elite_workers }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_smithing_guild_efficiency_build = yes }
		}
	}
	trait = {
		token = dorwinion_trait_elite_workers
		name = dorwinion_trait_elite_workers
		icon = GFX_generic_mio_trait_icon_unique

		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_better_tools

		any_parent = { dorwinion_trait_better_tools }
		mutually_exclusive = { dorwinion_trait_standardized_facilities }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_smithing_guild_efficiency_capacity = yes }
		}
	}
	trait = {
		token = dorwinion_trait_innovation_of_artisans
		name = dorwinion_trait_innovation_of_artisans
		icon = GFX_generic_mio_trait_icon_book

		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_standardized_facilities

		any_parent = { dorwinion_trait_standardized_facilities dorwinion_trait_elite_workers }
		
		on_complete = {
			FROM = {
				if = {
					limit = { has_country_flag = dorwinion_smithing_guild_efficiency_build }
					upgrade_to_dorwinion_smithing_guild_efficiency_build_tech = yes
				}
				else = {
					upgrade_to_dorwinion_smithing_guild_efficiency_capacity_tech = yes
				}
			}
		}
	}
	#########FOCUS TRAITS
	trait = {
		token = dorwinion_trait_pillar_of_society
		name = dorwinion_trait_pillar_of_society
		icon = GFX_generic_mio_trait_icon_political

		position = { x=10 y=0 }
		
		available = { FROM = { has_completed_focus = DOR_pillars_of_society } }
		
		organization_modifier = {
			military_industrial_organization_industrial_manufacturer_assign_cost = @pillarOfSocietyCostReduction
		}
	}
	trait = {
		token = dorwinion_trait_expanded_market
		name = dorwinion_trait_expanded_market
		icon = GFX_generic_mio_trait_icon_money

		position = { x=10 y=1 }
		
		available = { FROM = { has_completed_focus = DOR_expand_citizenship_rights } }
		
		organization_modifier = {
			military_industrial_organization_funds_gain = @expandedMarketFundsGain
		}
	}
####################################################
#######################################################INFANTRY EQUIPMENT
####################################################
	trait = {
		token = generic_mio_trait_drum_pattern_sights
		name = generic_mio_trait_drum_pattern_sights
		icon = GFX_generic_mio_trait_icon_defense

		position = { x=4 y=0 }

		equipment_bonus = {
			defense = 0.035
		}
	}

	trait = {
		token = generic_mio_trait_reinforced_stocks
		name = generic_mio_trait_reinforced_stocks
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=4 y=0 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		equipment_bonus = {
			soft_attack = 0.025
			reliability = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_bolt_action
		name = generic_mio_trait_bolt_action
		icon = GFX_generic_mio_department_icon_infantry_line_efficiency

		position = { x=-1 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_semi_auto }

		equipment_bonus = {
			soft_attack = -0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = 0.05
		}
	}

	trait = {
		token = generic_mio_trait_semi_auto
		name = generic_mio_trait_semi_auto
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_bolt_action }

		equipment_bonus = {
			soft_attack = 0.03
			breakthrough = 0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = -0.05
		}
	}

	trait = {
		token = generic_mio_trait_medium_machineguns
		name = generic_mio_trait_medium_machineguns
		icon = GFX_generic_mio_trait_icon_breakthrough

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_bolt_action

		any_parent = { generic_mio_trait_semi_auto generic_mio_trait_bolt_action }
		
		equipment_bonus = {
			breakthrough = -0.04
			build_cost_ic = -0.08
		}
	}

	trait = {
		token = generic_mio_trait_advanced_barrel_forging
		name = generic_mio_trait_advanced_barrel_forging
		icon = GFX_generic_mio_trait_icon_efficiency_gain

		position = { x=2 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		any_parent = { generic_mio_trait_reinforced_stocks generic_mio_trait_drum_pattern_sights }

		production_bonus = {
			production_efficiency_gain_factor = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_mass_rifle_production
		name = generic_mio_trait_mass_rifle_production
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging

		all_parents = { generic_mio_trait_advanced_barrel_forging }

		production_bonus = {
			production_efficiency_cap_factor = 0.03
			production_cost_factor = -0.03
		}

		organization_modifier = {
			military_industrial_organization_design_team_assign_cost = -0.3
		}
	}


	trait = {
		token = generic_mio_trait_quality_materials
		name = generic_mio_trait_quality_materials
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		all_parents = { generic_mio_trait_drum_pattern_sights }

		equipment_bonus = {
			reliability = 0.05
		}

	}

	trait = {
		token = generic_mio_trait_improved_small_arms_bullet_design
		name = generic_mio_trait_improved_small_arms_bullet_design
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=-1 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }

		mutually_exclusive = { generic_mio_trait_armor_piercing_rounds }

		equipment_bonus = {
			soft_attack = 0.05
			breakthrough = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_armor_piercing_rounds
		name = generic_mio_trait_armor_piercing_rounds
		icon = GFX_generic_mio_trait_icon_ap_attack

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }
		
		mutually_exclusive = { generic_mio_trait_improved_small_arms_bullet_design }

		equipment_bonus = {
			ap_attack = 0.25
			hard_attack = 0.05
		}
	}
}


##############################################################################################################################
# TAILORY GUILD
##############################################################################################################################
DOR_tailory_guild_MIO = {
	name = dorwinion_tailory_guild
	icon = GFX_idea_dorwinion_tailory_guild
	
	include = generic_support_equipment_organization
	
	allowed = {
		original_tag = DOR
	}
	available = { always = yes }
	
	equipment_type = {
		mio_cat_eq_all_support
	}
	research_categories = {
		support_tech
	}
	
	
	tree_header_text = {
		text = mio_header_commercial
		x = 1
	}
	tree_header_text = {
		text = mio_header_support_equipment
		x = 6
	}

	initial_trait = {
		name = tailor

		organization_modifier = {
			military_industrial_organization_research_bonus = 0.05
		}
		production_bonus = {
			production_resource_penalty_factor = -0.1
		}
	}

####################################################
#######################################################COMMERCIAL
####################################################
	trait = {
		token = dorwinion_trait_standardized_uniforms
		name = dorwinion_trait_standardized_uniforms
		icon = GFX_generic_mio_trait_icon_build_cost_ic

		position = { x=1 y=0 }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_tailory_guild_training = yes }
		}
	}
	trait = {
		token = dorwinion_trait_civilian_robes
		name = dorwinion_trait_civilian_robes
		icon = GFX_generic_mio_trait_icon_political

		position = { x=-1 y=2 }
		relative_position_id = dorwinion_trait_standardized_uniforms

		any_parent = { dorwinion_trait_standardized_uniforms }
		mutually_exclusive = { dorwinion_trait_winter_coats }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_tailory_guild_training_pp = yes }
		}
	}
	trait = {
		token = dorwinion_trait_mass_affordability
		name = dorwinion_trait_mass_affordability
		icon = GFX_generic_mio_trait_icon_money

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_civilian_robes
		
		any_parent = { dorwinion_trait_civilian_robes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_tailory_guild_training_pp_cg = yes }
		}
	}
	trait = {
		token = dorwinion_trait_winter_coats
		name = dorwinion_trait_winter_coats
		icon = GFX_generic_mio_trait_icon_supply_consumption

		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_standardized_uniforms
		
		any_parent = { dorwinion_trait_standardized_uniforms }
		mutually_exclusive = { dorwinion_trait_civilian_robes }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_tailory_guild_training_cold = yes }
		}
	}
	trait = {
		token = dorwinion_trait_hardy_uniforms
		name = dorwinion_trait_hardy_uniforms
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_winter_coats

		any_parent = { dorwinion_trait_winter_coats }
		
		on_complete = {
			FROM = { upgrade_to_dorwinion_tailory_guild_training_cold_attrition = yes  }
		}
	}
	#########FOCUS TRAITS
	trait = {
		token = dorwinion_trait_pillar_of_society
		name = dorwinion_trait_pillar_of_society
		icon = GFX_generic_mio_trait_icon_political

		position = { x=9 y=0 }
		
		available = { FROM = { has_completed_focus = DOR_pillars_of_society } }
		
		organization_modifier = {
			military_industrial_organization_industrial_manufacturer_assign_cost = @pillarOfSocietyCostReduction
		}
	}
	trait = {
		token = dorwinion_trait_expanded_market
		name = dorwinion_trait_expanded_market
		icon = GFX_generic_mio_trait_icon_money

		position = { x=9 y=1 }
		
		available = { FROM = { has_completed_focus = DOR_expand_citizenship_rights } }
		
		organization_modifier = {
			military_industrial_organization_funds_gain = @expandedMarketFundsGain
		}
	}
####################################################
#######################################################SUPPORT EQUIPMENT
####################################################
	override_trait = {
		token = generic_mio_trait_material_recycling
		name = generic_mio_trait_material_recycling
		icon = GFX_generic_mio_department_icon_support_materials
		
		position = { x=6 y=0 } 
		
		production_bonus = {
			production_resource_need_factor = -0.15
		}
	}
}

##############################################################################################################################
# RIVERSTALKERS
##############################################################################################################################
DOR_riverstalkers_MIO = {
	name = dorwinion_riverstalkers
	icon = GFX_idea_dorwinion_riverstalkers

	allowed = {
		original_tag = DOR
	}
	visible = { FROM = { NOT = { has_country_flag = disbanded_riverstalkers } } }
	available = { FROM = { has_completed_focus = DOR_hire_the_rabble } }
	
	equipment_type {
		example_airframe
	}
	tree_header_text = {
		text = mio_header_expand_mercenary
		x = 0
	}
	tree_header_text = {
		text = mio_header_template
		x = 3.5
	}
	tree_header_text = {
		text = mio_header_banners
		x = 7.5
	}

	initial_trait = {
		name = dorwinion_riverstalkers
	}
	trait = {
		token = dorwinion_trait_trusted_employer
		name = dorwinion_trait_trusted_employer
		icon = GFX_generic_mio_trait_icon_money
		
		position = { x=9 y=0 }
		
		available = {
			FROM = {
				has_completed_focus = DOR_trusted_employers
			}
		}
		
		organization_modifier = {
			military_industrial_organization_size_up_requirement = @trustedEmployerBonus
		}
	}

####################################################
#######################################################HIRE MORE
####################################################
	trait = {
		token = dorwinion_trait_hire_infantry1
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=0 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_rivers_infantry_unit
					custom_effect_tooltip = create_rivers_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"5th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
						create_unit = {
							division = "name = \"6th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
					}
				}
				calculate_riverstalkers_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry2
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry1
		
		any_parent = { dorwinion_trait_hire_infantry1 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_rivers_infantry_unit
					custom_effect_tooltip = create_rivers_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"7th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
						create_unit = {
							division = "name = \"8th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
					}
				}
				calculate_riverstalkers_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry3
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry2
		
		any_parent = { dorwinion_trait_hire_infantry2 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_rivers_infantry_unit
					custom_effect_tooltip = create_rivers_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"9th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
						create_unit = {
							division = "name = \"10th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
					}
				}
				calculate_riverstalkers_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry4
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry3
		
		any_parent = { dorwinion_trait_hire_infantry3 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_rivers_infantry_unit
					custom_effect_tooltip = create_rivers_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"11th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
						create_unit = {
							division = "name = \"12th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
					}
				}
				calculate_riverstalkers_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry5
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry4
		
		any_parent = { dorwinion_trait_hire_infantry4 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_rivers_infantry_unit
					custom_effect_tooltip = create_rivers_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"13th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
						create_unit = {
							division = "name = \"14th Stalkers\" division_template = \"Riverstalkers\" start_experience_factor = 0.075"
							owner = FROM
						}
					}
				}
				calculate_riverstalkers_costs = yes
			}
		}
	}
####################################################
#######################################################TEMPLATE
####################################################
	trait = {
		token = dorwinion_trait_add_irregulars
		name = dorwinion_trait_add_irregulars
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=2 y=0 }
		mutually_exclusive = { dorwinion_trait_add_javelins }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					regiments = {
						irregular_infantry = 1
					}
				}
				hidden_effect = { #Grants equipment & manpower for the newly spawned battalions
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = @equipForIrregular }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_irregulars2
		name = dorwinion_trait_add_irregulars
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_irregulars
		any_parent = { dorwinion_trait_add_irregulars }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					regiments = {
						irregular_infantry = 1
					}
				}
				hidden_effect = { #Grants equipment & manpower for the newly spawned battalions
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = @equipForIrregular }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_javelins
		name = dorwinion_trait_add_javelins
		icon = GFX_military_industrial_organization_rocket
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_irregulars
		mutually_exclusive = {
			dorwinion_trait_add_irregulars
			dorwinion_trait_add_support_javelins
		}
		
		available = {
			FROM = {
				has_tech = javelins1
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					regiments = {
						rocket_artillery_brigade = 2
					}
				}
				hidden_effect = { #Grants equipment & manpower for the newly spawned battalions
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = @equipForArtillery }
						add_equipment_to_stockpile = {
							type = rocket_artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_javelins2
		name = dorwinion_trait_add_javelins
		icon = GFX_military_industrial_organization_rocket
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_javelins
		any_parent = { dorwinion_trait_add_javelins }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					regiments = {
						rocket_artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = @equipForArtillery }
						add_equipment_to_stockpile = {
							type = rocket_artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_support_javelins
		name = dorwinion_trait_add_support_javelins
		icon = GFX_military_industrial_organization_rocket
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_javelins
		mutually_exclusive = { dorwinion_trait_add_javelins }
		
		available = {
			FROM = {
				has_tech = javelins1
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					support = {
						rocket_artillery = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = @equipForSupportArtillery }
						add_equipment_to_stockpile = {
							type = rocket_artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupportArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_add_recon
		name = dorwinion_trait_add_recon
		icon = GFX_generic_mio_trait_icon_surface_detection
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_support_javelins
		
		available = {
			FROM = {
				has_tech = tech_recon
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Riverstalkers"
					support = {
						recon = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { equipment_to_add = 40 }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@riverstalkers_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}

####################################################
#######################################################BANNER BUFFS
####################################################
	trait = {
		token = dorwinion_trait_banner_supply
		name = DOR_riverstalkers_supply
		icon = GFX_generic_mio_trait_icon_supply_consumption
		
		position = { x=7 y=0 }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_riverstalkers_supply_tooltip
				hidden_effect = {
					set_technology = {
						DOR_riverstalkers_supply = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_reliability
		name = DOR_riverstalkers_reliability
		icon = GFX_generic_mio_trait_icon_reliability
		
		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_banner_supply
		any_parent = { dorwinion_trait_banner_supply }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_riverstalkers_reliability_tooltip
				hidden_effect = {
					set_technology = {
						DOR_riverstalkers_reliability = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_river
		name = DOR_riverstalkers_river
		icon = GFX_generic_mio_trait_icon_sub_detection
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_banner_supply
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_riverstalkers_river_tooltip
				hidden_effect = {
					set_technology = {
						DOR_riverstalkers_river = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_movement
		name = DOR_riverstalkers_movement
		icon = GFX_generic_mio_trait_icon_maximum_speed
		
		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_banner_river
		any_parent = { dorwinion_trait_banner_river }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_riverstalkers_movement_tooltip
				hidden_effect = {
					set_technology = {
						DOR_riverstalkers_movement = 1
						popup = no
					}
				}
			}
		}
	}
}

##############################################################################################################################
# MOUNTAINS VENGEANCE
##############################################################################################################################
DOR_mountains_vengeance_MIO = {
	name = dorwinion_mountains_vengeance
	icon = GFX_idea_dorwinion_mountains_vengeance

	allowed = {
		original_tag = DOR
	}
	visible = { FROM = { NOT = { has_country_flag = disbanded_mountains_vengeance } } }
	available = { FROM = { has_completed_focus = DOR_hire_the_dwarves } }
	
	equipment_type {
		infantry_equipment
		infantry_armor
		example_airframe
	}
	research_categories = {
		infantry_tech
	}
	tree_header_text = {
		text = mio_header_expand_mercenary
		x = 0
	}
	tree_header_text = {
		text = mio_header_template
		x = 2
	}
	tree_header_text = {
		text = mio_header_banners
		x = 4
	}
	tree_header_text = {
		text = mio_header_weapons_and_armor
		x = 7
	}

	initial_trait = {
		name = dorwinion_mountains_vengeance
	}
	trait = {
		token = dorwinion_trait_trusted_employer
		name = dorwinion_trait_trusted_employer
		icon = GFX_generic_mio_trait_icon_money
		
		position = { x=9 y=0 }
		
		available = {
			FROM = {
				has_completed_focus = DOR_trusted_employers
			}
		}
		
		organization_modifier = {
			military_industrial_organization_size_up_requirement = @trustedEmployerBonus
		}
	}

####################################################
#######################################################HIRE MORE
####################################################
	trait = {
		token = dorwinion_trait_hire_infantry1
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=0 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_mountains_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Mountain's 4th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_mountains_vengeance_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry2
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry1
		
		any_parent = { dorwinion_trait_hire_infantry1 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_mountains_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Mountain's 5th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_mountains_vengeance_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry3
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry2
		
		any_parent = { dorwinion_trait_hire_infantry2 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_mountains_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Mountain's 6th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_mountains_vengeance_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry4
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry3
		
		any_parent = { dorwinion_trait_hire_infantry3 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_mountains_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Mountain's 7th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_mountains_vengeance_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry5
		name = dorwinion_trait_hire_two_infantry
		icon = GFX_military_industrial_organization_infantry_armor
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry4
		
		any_parent = { dorwinion_trait_hire_infantry4 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_mountains_infantry_unit
					custom_effect_tooltip = create_mountains_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Mountain's 8th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
						create_unit = {
							division = "name = \"Mountain's 9th Infantry\" division_template = \"Mountain's Infantry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_mountains_vengeance_costs = yes
			}
		}
	}
####################################################
#######################################################SUPPORT
####################################################	
	trait = {
		token = dorwinion_trait_add_engineer
		name = dorwinion_trait_add_engineer
		icon = GFX_generic_mio_trait_icon_entrenchment
		
		position = { x=1 y=0 }
		
		available = {
			FROM = {
				has_tech = tech_combined_engineers
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					support = {
						siege_engineer = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						set_variable = { secondary_equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						multiply_variable = { secondary_equipment_to_add = @infEquipForSupport }
						add_equipment_to_stockpile = {
							type = engineering_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:secondary_equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_engineer_equipment
		name = dorwinion_trait_engineer_equipment
		icon = GFX_military_industrial_organization_engineering_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_engineer
		any_parent = { dorwinion_trait_add_engineer }
		
		on_complete = {
			custom_effect_tooltip = one_engineer_per_MV_unit
		}
	}
	trait = {
		token = dorwinion_trait_add_maintenance
		name = dorwinion_trait_add_maintenance
		icon = GFX_generic_mio_trait_icon_efficiency_cap
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_engineer
		
		available = {
			FROM = {
				has_tech = tech_maintenance_company
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					support = {
						maintenance_company = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = maintenance_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_maintenance_equipment
		name = dorwinion_trait_maintenance_equipment
		icon = GFX_military_industrial_organization_maintenance_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_maintenance
		any_parent = { dorwinion_trait_add_maintenance }
		
		on_complete = {
			custom_effect_tooltip = one_maintenance_per_MV_unit
		}
	}
	trait = {
		token = dorwinion_trait_add_medical
		name = dorwinion_trait_add_medical
		icon = GFX_generic_mio_trait_icon_political
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_maintenance
		
		available = {
			FROM = {
				has_tech = tech_field_hospital
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					support = {
						field_hospital = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = medical_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_medical_equipment
		name = dorwinion_trait_medical_equipment
		icon = GFX_military_industrial_organization_medical_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_medical
		any_parent = { dorwinion_trait_add_medical }
		
		on_complete = {
			custom_effect_tooltip = one_medical_per_MV_unit
		}
	}
####################################################
#######################################################TEMPLATE
####################################################
	trait = {
		token = dorwinion_trait_add_heavy_infantry
		name = dorwinion_trait_add_heavy_infantry
		icon = GFX_military_industrial_organization_infantry_armor
		
		position = { x=0 y=3 }
		relative_position_id = dorwinion_trait_add_engineer
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					regiments = {
						heavy_infantry = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_infantry2
		name = dorwinion_trait_add_heavy_infantry
		icon = GFX_military_industrial_organization_infantry_armor
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		any_parent = { dorwinion_trait_add_heavy_infantry }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					regiments = {
						heavy_infantry = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_pikes
		name = dorwinion_trait_add_heavy_pikes
		icon = GFX_military_industrial_organization_anti_tank
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					regiments = {
						heavy_pikes_brigade = 1
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = anti_tank_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_pikes2
		name = dorwinion_trait_add_heavy_pikes
		icon = GFX_military_industrial_organization_anti_tank
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_pikes
		any_parent = { dorwinion_trait_add_heavy_pikes }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					regiments = {
						heavy_pikes_brigade = 1
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = anti_tank_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_crossbows
		name = dorwinion_trait_add_crossbows
		icon = GFX_military_industrial_organization_artillery
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_pikes
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					regiments = {
						artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForArtillery }
						add_equipment_to_stockpile = {
							type = artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_support_crossbows
		name = dorwinion_trait_add_support_crossbows
		icon = GFX_military_industrial_organization_artillery
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_crossbows
		
		available = {
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Mountain's Infantry"
					support = {
						artillery = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { equipment_to_add = @equipForSupportArtillery }
						add_equipment_to_stockpile = {
							type = artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@mountains_vengeance_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupportArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}

####################################################
#######################################################BANNER BUFFS
####################################################
	trait = {
		token = dorwinion_trait_banner_defense
		name = DOR_mountains_vengeance_defense
		icon = GFX_generic_mio_trait_icon_defense
		
		position = { x=4 y=0 }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_mountains_vengeance_defense_tooltip
				hidden_effect = {
					set_technology = {
						DOR_mountains_vengeance_defense = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_hp
		name = DOR_mountains_vengeance_hp
		icon = GFX_generic_mio_trait_icon_max_strength
		
		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_banner_defense
		any_parent = { dorwinion_trait_banner_defense }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_mountains_vengeance_hp_tooltip
				hidden_effect = {
					set_technology = {
						DOR_mountains_vengeance_hp = 1
						popup = no
					}
				}
			}
		}
	}
####################################################
#######################################################INFANTRY EQUIPMENT
####################################################
	trait = {
		token = generic_mio_trait_drum_pattern_sights
		name = generic_mio_trait_drum_pattern_sights
		icon = GFX_generic_mio_trait_icon_defense

		position = { x=6 y=0 }
		
		available = { FROM = { has_completed_focus = DOR_commission_their_other_skills } }

		equipment_bonus = {
			defense = 0.035
		}
		organization_modifier = {
			military_industrial_organization_research_bonus = 0.025
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.025
		}
	}

	trait = {
		token = generic_mio_trait_reinforced_stocks
		name = generic_mio_trait_reinforced_stocks
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=2 y=0 }
		relative_position_id = generic_mio_trait_drum_pattern_sights
		available = { FROM = { has_completed_focus = DOR_commission_their_other_skills } }

		equipment_bonus = {
			soft_attack = 0.025
			reliability = 0.03
		}
		organization_modifier = {
			military_industrial_organization_research_bonus = 0.025
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.025
		}
	}

	trait = {
		token = generic_mio_trait_bolt_action
		name = generic_mio_trait_bolt_action
		icon = GFX_generic_mio_department_icon_infantry_line_efficiency

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_semi_auto }

		equipment_bonus = {
			soft_attack = -0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = 0.05
		}
	}

	trait = {
		token = generic_mio_trait_semi_auto
		name = generic_mio_trait_semi_auto
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_bolt_action }

		equipment_bonus = {
			soft_attack = 0.03
			breakthrough = 0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = -0.05
		}
	}

	trait = {
		token = generic_mio_trait_medium_machineguns
		name = generic_mio_trait_medium_machineguns
		icon = GFX_generic_mio_trait_icon_breakthrough

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_bolt_action

		any_parent = { generic_mio_trait_semi_auto generic_mio_trait_bolt_action }
		
		equipment_bonus = {
			breakthrough = 0.06
			build_cost_ic = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_advanced_barrel_forging
		name = generic_mio_trait_advanced_barrel_forging
		icon = GFX_generic_mio_trait_icon_efficiency_gain

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		any_parent = { generic_mio_trait_reinforced_stocks generic_mio_trait_drum_pattern_sights }

		production_bonus = {
			production_efficiency_gain_factor = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_mass_rifle_production
		name = generic_mio_trait_mass_rifle_production
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging

		all_parents = { generic_mio_trait_advanced_barrel_forging }

		production_bonus = {
			production_efficiency_cap_factor = 0.03
			production_cost_factor = -0.03
		}

		organization_modifier = {
			military_industrial_organization_design_team_assign_cost = -0.3
		}
	}


	trait = {
		token = generic_mio_trait_quality_materials
		name = generic_mio_trait_quality_materials
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		all_parents = { generic_mio_trait_drum_pattern_sights }

		equipment_bonus = {
			reliability = 0.05
		}

	}

	trait = {
		token = generic_mio_trait_improved_small_arms_bullet_design
		name = generic_mio_trait_improved_small_arms_bullet_design
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=-1 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }

		mutually_exclusive = { generic_mio_trait_armor_piercing_rounds }

		equipment_bonus = {
			soft_attack = 0.05
			breakthrough = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_armor_piercing_rounds
		name = generic_mio_trait_armor_piercing_rounds
		icon = GFX_generic_mio_trait_icon_ap_attack

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }
		
		mutually_exclusive = { generic_mio_trait_improved_small_arms_bullet_design }

		equipment_bonus = {
			ap_attack = 0.25
			hard_attack = 0.05
		}
	}
}

##############################################################################################################################
# DRAGONS BREATH
##############################################################################################################################
DOR_dragons_breath_MIO = {
	name = dorwinion_dragons_breath
	icon = GFX_idea_dorwinion_dragons_breath

	allowed = {
		original_tag = DOR
	}
	visible = { FROM = { NOT = { has_country_flag = disbanded_dragons_breath } } }
	available = { FROM = { has_completed_focus = DOR_hire_the_cavalry } }
	
	equipment_type {
		example_airframe
	}
	tree_header_text = {
		text = mio_header_expand_mercenary
		x = 0
	}
	tree_header_text = {
		text = mio_header_template
		x = 3
	}
	tree_header_text = {
		text = mio_header_banners
		x = 7
	}

	initial_trait = {
		name = dorwinion_dragons_breath
	}
	
	trait = {
		token = dorwinion_trait_trusted_employer
		name = dorwinion_trait_trusted_employer
		icon = GFX_generic_mio_trait_icon_money
		
		position = { x=9 y=0 }
		
		available = {
			FROM = {
				has_completed_focus = DOR_trusted_employers
			}
		}
		
		organization_modifier = {
			military_industrial_organization_size_up_requirement = @trustedEmployerBonus
		}
	}

####################################################
#######################################################HIRE MORE
####################################################
	trait = {
		token = dorwinion_trait_hire_cavalry1
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_light_tank_chassis
		
		position = { x=0 y=0 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_dragons_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Dragon's 4th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_dragons_breath_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry2
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_light_tank_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_cavalry1
		
		any_parent = { dorwinion_trait_hire_cavalry1 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_dragons_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Dragon's 5th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_dragons_breath_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry3
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_light_tank_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_cavalry2
		
		any_parent = { dorwinion_trait_hire_cavalry2 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_dragons_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Dragon's 6th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_dragons_breath_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry4
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_light_tank_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_cavalry3
		
		any_parent = { dorwinion_trait_hire_cavalry3 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_dragons_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Dragon's 7th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_dragons_breath_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry5
		name = dorwinion_trait_hire_two_cavalry
		icon = GFX_military_industrial_organization_armor
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_cavalry4
		
		any_parent = { dorwinion_trait_hire_cavalry4 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_dragons_cavalry_unit
					custom_effect_tooltip = create_dragons_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Dragon's 8th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
						create_unit = {
							division = "name = \"Dragon's 9th Cavalry\" division_template = \"Dragon's Cavalry\" start_experience_factor = 0.4"
							owner = FROM
						}
					}
				}
				calculate_dragons_breath_costs = yes
			}
		}
	}
####################################################
#######################################################SUPPORT
####################################################	
	trait = {
		token = dorwinion_trait_add_logistics
		name = dorwinion_trait_add_logistics
		icon = GFX_generic_mio_trait_icon_supply_consumption
		
		position = { x=2 y=0 }
		
		available = {
			FROM = {
				has_tech = tech_logistics_company
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					support = {
						logistics_company = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = motorized_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_motorized_equipment
		name = dorwinion_trait_motorized_equipment
		icon = GFX_military_industrial_organization_motorized
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_logistics
		any_parent = { dorwinion_trait_add_logistics }
		
		on_complete = {
			custom_effect_tooltip = one_wagon_per_DB_unit
		}
	}
	trait = {
		token = dorwinion_trait_add_recon
		name = dorwinion_trait_add_recon
		icon = GFX_generic_mio_trait_icon_surface_detection
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_logistics
		
		available = {
			FROM = {
				has_tech = tech_recon
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					support = {
						light_tank_recon = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = light_tank_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_add_signals
		name = dorwinion_trait_add_signals
		icon = GFX_generic_mio_trait_icon_unique
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_recon
		
		available = {
			FROM = {
				has_tech = tech_signal_company
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					support = {
						signal_company = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = signals_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_signals_equipment
		name = dorwinion_trait_signals_equipment
		icon = GFX_military_industrial_organization_signals_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_signals
		any_parent = { dorwinion_trait_add_signals }
		
		on_complete = {
			custom_effect_tooltip = one_signals_per_DB_unit
		}
	}
####################################################
#######################################################TEMPLATE
####################################################
	trait = {
		token = dorwinion_trait_add_chariot
		name = dorwinion_trait_add_chariot
		icon = GFX_military_industrial_organization_mechanized
		
		position = { x=0 y=3 }
		relative_position_id = dorwinion_trait_add_logistics
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					regiments = {
						mechanized = 1
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						set_variable = { secondary_equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { secondary_equipment_to_add = 40 }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = mechanized_equipment
							amount = var:secondary_equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_lancers
		name = dorwinion_trait_add_heavy_lancers
		icon = GFX_military_industrial_organization_medium_tank_destroyer_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_chariot
		
		mutually_exclusive = { dorwinion_trait_add_light_skirmishers }
		
		available = {
			FROM = {
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_td
				}
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					regiments = {
						medium_tank_destroyer_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = medium_tank_destroyer_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_lancers2
		name = dorwinion_trait_add_heavy_lancers
		icon = GFX_military_industrial_organization_medium_tank_destroyer_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_lancers
		any_parent = { dorwinion_trait_add_heavy_lancers }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					regiments = {
						medium_tank_destroyer_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = medium_tank_destroyer_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_light_skirmishers
		name = dorwinion_trait_add_light_skirmishers
		icon = GFX_military_industrial_organization_light_tank_artillery_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_lancers
		
		mutually_exclusive = { dorwinion_trait_add_heavy_lancers }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					regiments = {
						light_sp_artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = light_tank_artillery_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_light_skirmishers2
		name = dorwinion_trait_add_light_skirmishers
		icon = GFX_military_industrial_organization_light_tank_artillery_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_light_skirmishers
		any_parent = { dorwinion_trait_add_light_skirmishers }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Dragon's Cavalry"
					regiments = {
						light_sp_artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = light_tank_artillery_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@dragons_breath_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}

####################################################
#######################################################BANNER BUFFS
####################################################
	trait = {
		token = dorwinion_trait_banner_speed
		name = DOR_dragons_breath_speed
		icon = GFX_generic_mio_trait_icon_maximum_speed
		
		position = { x=7 y=0 }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_dragons_breath_speed_tooltip
				hidden_effect = {
					set_technology = {
						DOR_dragons_breath_speed = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_breakthrough
		name = DOR_dragons_breath_breakthrough
		icon = GFX_generic_mio_trait_icon_breakthrough
		
		position = { x=-1 y=2 }
		relative_position_id = dorwinion_trait_banner_speed
		any_parent = { dorwinion_trait_banner_speed }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_dragons_breath_breakthrough_tooltip
				hidden_effect = {
					set_technology = {
						DOR_dragons_breath_breakthrough = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_armor
		name = DOR_dragons_breath_armor
		icon = GFX_generic_mio_trait_icon_max_strength
		
		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_banner_breakthrough
		any_parent = { dorwinion_trait_banner_breakthrough }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_dragons_breath_armor_tooltip
				hidden_effect = {
					set_technology = {
						DOR_dragons_breath_armor = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_soft_attack
		name = DOR_dragons_breath_soft_attack
		icon = GFX_generic_mio_trait_icon_soft_attack
		
		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_banner_speed
		any_parent = { dorwinion_trait_banner_speed }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_dragons_breath_soft_attack_tooltip
				hidden_effect = {
					set_technology = {
						DOR_dragons_breath_soft_attack = 1
						popup = no
					}
				}
			}
		}
	}
}
##############################################################################################################################
# COMPANY OF WINTER
##############################################################################################################################
DOR_company_of_winter_MIO = {
	name = dorwinion_company_of_winter
	icon = GFX_idea_dorwinion_company_of_winter

	allowed = {
		original_tag = DOR
	}
	visible = { FROM = { NOT = { has_country_flag = disbanded_company_of_winter } } }
	available = { FROM = { has_completed_focus = DOR_hire_the_elites } }
	
	equipment_type {
		example_airframe
	}
	
	tree_header_text = {
		text = mio_header_expand_mercenary
		x = 0.5
	}
	tree_header_text = {
		text = mio_header_support_companies
		x = 2.5
	}
	tree_header_text = {
		text = mio_header_template
		x = 5
	}
	tree_header_text = {
		text = mio_header_banners
		x = 8
	}

	initial_trait = {
		name = dorwinion_company_of_winter
	}
	trait = {
		token = dorwinion_trait_trusted_employer
		name = dorwinion_trait_trusted_employer
		icon = GFX_generic_mio_trait_icon_money
		
		position = { x=9 y=0 }
		
		available = {
			FROM = {
				has_completed_focus = DOR_trusted_employers
			}
		}
		
		organization_modifier = {
			military_industrial_organization_size_up_requirement = @trustedEmployerBonus
		}
	}

####################################################
#######################################################HIRE MORE
####################################################
	trait = {
		token = dorwinion_trait_hire_infantry1
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=0 }

		mutually_exclusive = { dorwinion_trait_hire_cavalry1 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 3rd Infantry\" division_template = \"Winter's Infantry\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry1
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_hire_infantry1

		mutually_exclusive = { dorwinion_trait_hire_infantry1 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
				has_design_based_on = medium_tank_chassis
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 1st Knights\" division_template = \"Winter's Knights\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry2
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry1
		any_parent = { dorwinion_trait_hire_infantry1 dorwinion_trait_hire_cavalry1 }
		
		mutually_exclusive = { dorwinion_trait_hire_cavalry2 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 4th Infantry\" division_template = \"Winter's Infantry\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry2
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_hire_infantry2
		any_parent = { dorwinion_trait_hire_infantry1 dorwinion_trait_hire_cavalry1 }

		mutually_exclusive = { dorwinion_trait_hire_infantry2 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_tank
				}
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 2nd Knights\" division_template = \"Winter's Knights\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry3
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry2
		any_parent = { dorwinion_trait_hire_infantry2 dorwinion_trait_hire_cavalry2 }
		
		mutually_exclusive = { dorwinion_trait_hire_cavalry3 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 5th Infantry\" division_template = \"Winter's Infantry\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry3
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_hire_infantry3
		any_parent = { dorwinion_trait_hire_infantry2 dorwinion_trait_hire_cavalry2 }

		mutually_exclusive = { dorwinion_trait_hire_infantry3 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_tank
				}
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 3rd Knights\" division_template = \"Winter's Knights\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry4
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry3
		any_parent = { dorwinion_trait_hire_infantry3 dorwinion_trait_hire_cavalry3 }
		
		mutually_exclusive = { dorwinion_trait_hire_cavalry4 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 6th Infantry\" division_template = \"Winter's Infantry\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry4
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_hire_infantry4
		any_parent = { dorwinion_trait_hire_infantry3 dorwinion_trait_hire_cavalry3 }

		mutually_exclusive = { dorwinion_trait_hire_infantry4 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_tank
				}
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 4th Knights\" division_template = \"Winter's Knights\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_infantry5
		name = dorwinion_trait_hire_infantry
		icon = GFX_military_industrial_organization_infantry
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_hire_infantry4
		any_parent = { dorwinion_trait_hire_infantry4 dorwinion_trait_hire_cavalry4 }
		
		mutually_exclusive = { dorwinion_trait_hire_cavalry5 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_infantry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 7th Infantry\" division_template = \"Winter's Infantry\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
	trait = {
		token = dorwinion_trait_hire_cavalry5
		name = dorwinion_trait_hire_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_hire_infantry5
		any_parent = { dorwinion_trait_hire_infantry4 dorwinion_trait_hire_cavalry4 }

		mutually_exclusive = { dorwinion_trait_hire_infantry5 }
		
		available = {
			FROM = {
				num_of_civilian_factories_available_for_projects > 0
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_tank
				}
			}
		}
		
		on_complete = {
			FROM = {
				capital_scope = {
					custom_effect_tooltip = create_winters_cavalry_unit
					hidden_effect = {
						create_unit = {
							division = "name = \"Winter's 5th Knights\" division_template = \"Winter's Knights\" start_experience_factor = 0.75"
							owner = FROM
						}
					}
				}
				calculate_company_of_winter_costs = yes
			}
		}
	}
####################################################
#######################################################ADD SUPPORT
####################################################
	trait = {
		token = dorwinion_trait_add_signals
		name = dorwinion_trait_add_signals
		icon = GFX_generic_mio_trait_icon_surface_detection
		
		position = { x=2 y=0 }
		
		available = {
			FROM = {
				has_tech = tech_signal_company
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					support = {
						signal_company = 0
					}
				}
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					support = {
						signal_company = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = signals_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_signals_equipment
		name = dorwinion_trait_signals_equipment
		icon = GFX_military_industrial_organization_signals_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_signals
		any_parent = { dorwinion_trait_add_signals }
		
		on_complete = {
			custom_effect_tooltip = one_signals_per_CoW_unit
		}
	}
	trait = {
		token = dorwinion_trait_add_medical
		name = dorwinion_trait_add_medical
		icon = GFX_generic_mio_trait_icon_political
		
		position = { x=0 y=3 }
		relative_position_id = dorwinion_trait_add_signals
		
		available = {
			FROM = {
				has_tech = tech_field_hospital
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					support = {
						field_hospital = 0
					}
				}
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					support = {
						field_hospital = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = medical_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_medical_equipment
		name = dorwinion_trait_medical_equipment
		icon = GFX_military_industrial_organization_medical_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_medical
		any_parent = { dorwinion_trait_add_medical }
		
		on_complete = {
			custom_effect_tooltip = one_medical_per_CoW_unit
		}
	}
	
	trait = {
		token = dorwinion_trait_add_engineer
		name = dorwinion_trait_add_engineer
		icon = GFX_generic_mio_trait_icon_entrenchment
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_signals
		
		available = {
			FROM = {
				has_tech = tech_combined_engineers
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					support = {
						engineer = 0
					}
				}
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					support = {
						engineer = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						set_variable = { secondary_equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						multiply_variable = { secondary_equipment_to_add = @infEquipForSupport }
						add_equipment_to_stockpile = {
							type = engineering_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:secondary_equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_engineer_equipment
		name = dorwinion_trait_engineer_equipment
		icon = GFX_military_industrial_organization_engineering_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_engineer
		any_parent = { dorwinion_trait_add_engineer }
		
		on_complete = {
			custom_effect_tooltip = one_engineer_per_CoW_unit
		}
	}
	trait = {
		token = dorwinion_trait_add_maintenance
		name = dorwinion_trait_add_maintenance
		icon = GFX_generic_mio_trait_icon_efficiency_cap
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_medical
		
		available = {
			FROM = {
				has_tech = tech_maintenance_company
			}
			custom_trigger_tooltip = {
				tooltip = has_at_least_one_support_slot_remaining_tooltip
				check_variable = { num_support_companies < 5 }
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					support = {
						maintenance_company = 0
					}
				}
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					support = {
						maintenance_company = 0
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForSupport }
						add_equipment_to_stockpile = {
							type = maintenance_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForSupport }
						add_manpower = var:manpower_to_add
					}
				}
			}
			add_to_variable = { num_support_companies = 1 }
		}
	}
	trait = {
		token = dorwinion_trait_maintenance_equipment
		name = dorwinion_trait_maintenance_equipment
		icon = GFX_military_industrial_organization_maintenance_equipment
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_maintenance
		any_parent = { dorwinion_trait_add_maintenance }
		
		on_complete = {
			custom_effect_tooltip = one_maintenance_per_CoW_unit
		}
	}
####################################################
#######################################################ADD INFANTRY
####################################################
	trait = {
		token = dorwinion_trait_add_heavy_infantry
		name = dorwinion_trait_add_heavy_infantry
		icon = GFX_military_industrial_organization_infantry_armor
		
		position = { x=4 y=0 }
		
		mutually_exclusive = { dorwinion_trait_add_heavy_pikes dorwinion_trait_add_bows }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						heavy_infantry = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_heavy_infantry
		name = dorwinion_trait_add_two_heavy_infantry
		icon = GFX_military_industrial_organization_infantry_armor
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		any_parent = { dorwinion_trait_add_heavy_infantry }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						heavy_infantry = 2
						heavy_infantry = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = infantry_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_pikes
		name = dorwinion_trait_add_heavy_pikes
		icon = GFX_military_industrial_organization_anti_tank
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		
		mutually_exclusive = { dorwinion_trait_add_heavy_infantry dorwinion_trait_add_bows }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						heavy_pikes_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						add_equipment_to_stockpile = {
							type = anti_tank_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_heavy_pikes
		name = dorwinion_trait_add_two_heavy_pikes
		icon = GFX_military_industrial_organization_anti_tank
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_pikes
		any_parent = { dorwinion_trait_add_heavy_pikes }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						heavy_pikes_brigade = 2
						heavy_pikes_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForInfantry }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = anti_tank_equipment
							amount = var:equipment_to_add
						}
						add_equipment_to_stockpile = {
							type = infantry_armor
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForInfantry }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_bows
		name = dorwinion_trait_add_bows
		icon = GFX_military_industrial_organization_artillery
		
		position = { x=2 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		
		mutually_exclusive = { dorwinion_trait_add_heavy_pikes dorwinion_trait_add_heavy_infantry }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForArtillery }
						add_equipment_to_stockpile = {
							type = artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForArtillery }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_bows
		name = dorwinion_trait_add_two_bows
		icon = GFX_military_industrial_organization_artillery
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_bows
		any_parent = { dorwinion_trait_add_bows }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Infantry"
					regiments = {
						artillery_brigade = 2
						artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForArtillery }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = artillery_equipment
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForArtillery }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
####################################################
#######################################################ADD CAVALRY
####################################################
	trait = {
		token = dorwinion_trait_add_heavy_cavalry
		name = dorwinion_trait_add_heavy_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=0 y=3 }
		relative_position_id = dorwinion_trait_add_heavy_infantry
		
		mutually_exclusive = { dorwinion_trait_add_heavy_lancers dorwinion_trait_add_light_skirmishers }
		
		available = {
			FROM = {
				if = {
					limit = { has_dlc = "No Step Back" }
					has_tech = basic_medium_tank_chassis
				}
				else = {
					has_tech = basic_medium_tank
				}
			}
		}
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						medium_armor = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = medium_tank_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_heavy_cavalry
		name = dorwinion_trait_add_two_heavy_cavalry
		icon = GFX_military_industrial_organization_medium_tank_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_cavalry
		any_parent = { dorwinion_trait_add_heavy_cavalry }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						medium_armor = 2
						medium_armor = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = medium_tank_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_heavy_lancers
		name = dorwinion_trait_add_heavy_lancers
		icon = GFX_military_industrial_organization_medium_tank_destroyer_chassis
		
		position = { x=1 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_cavalry
		
		mutually_exclusive = { dorwinion_trait_add_heavy_cavalry dorwinion_trait_add_light_skirmishers }
		
		available = {
			FROM = {
				has_design_based_on = medium_tank_destroyer_chassis
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						medium_tank_destroyer_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = medium_tank_destroyer_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_heavy_lancers
		name = dorwinion_trait_add_two_heavy_lancers
		icon = GFX_military_industrial_organization_medium_tank_destroyer_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_heavy_lancers
		any_parent = { dorwinion_trait_add_heavy_lancers }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						medium_tank_destroyer_brigade = 2
						medium_tank_destroyer_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = medium_tank_destroyer_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_light_skirmishers
		name = dorwinion_trait_add_light_skirmishers
		icon = GFX_military_industrial_organization_light_tank_artillery_chassis
		
		position = { x=2 y=0 }
		relative_position_id = dorwinion_trait_add_heavy_cavalry
		
		mutually_exclusive = { dorwinion_trait_add_heavy_lancers dorwinion_trait_add_heavy_cavalry }
		
		available = {
			FROM = {
				has_design_based_on = light_tank_artillery_chassis
			}
		}
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						light_sp_artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						add_equipment_to_stockpile = {
							type = light_tank_artillery_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_add_two_light_skirmishers
		name = dorwinion_trait_add_two_light_skirmishers
		icon = GFX_military_industrial_organization_light_tank_artillery_chassis
		
		position = { x=0 y=1 }
		relative_position_id = dorwinion_trait_add_light_skirmishers
		any_parent = { dorwinion_trait_add_light_skirmishers }
		
		on_complete = {
			FROM = {
				add_units_to_division_template = {
					template_name = "Winter's Knights"
					regiments = {
						light_sp_artillery_brigade = 2
						light_sp_artillery_brigade = 2
					}
				}
				#Grants equipment & manpower for the newly spawned battalions
				hidden_effect = {
					if = {
						limit = { FROM = { has_country_flag = fillMercenaryBattalions } }
						set_variable = { equipment_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { equipment_to_add = @equipForTanks }
						multiply_variable = { equipment_to_add = 2 }
						add_equipment_to_stockpile = {
							type = light_tank_artillery_chassis
							amount = var:equipment_to_add
						}
						set_variable = { manpower_to_add = num_battalions_with_type@company_of_winter_banner }
						multiply_variable = { manpower_to_add = @manpowerForTanks }
						multiply_variable = { manpower_to_add = 2 }
						add_manpower = var:manpower_to_add
					}
				}
			}
		}
	}
####################################################
#######################################################BANNER BUFF
####################################################
	trait = {
		token = dorwinion_trait_banner_morale
		name = DOR_company_of_winter_morale
		icon = GFX_generic_mio_trait_icon_crown
		
		position = { x=8 y=0 }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_company_of_winter_morale_tooltip
				hidden_effect = {
					set_technology = {
						DOR_company_of_winter_morale = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_initiative
		name = DOR_company_of_winter_initiative
		icon = GFX_generic_mio_trait_icon_maximum_speed
		
		position = { x=0 y=2 }
		relative_position_id = dorwinion_trait_banner_morale
		any_parent = { dorwinion_trait_banner_morale }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_company_of_winter_initiative_tooltip
				hidden_effect = {
					set_technology = {
						DOR_company_of_winter_initiative = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_soft_attack
		name = DOR_company_of_winter_soft_attack
		icon = GFX_generic_mio_trait_icon_soft_attack
		
		position = { x=-1 y=2 }
		relative_position_id = dorwinion_trait_banner_initiative
		any_parent = { dorwinion_trait_banner_initiative }
		
		mutually_exclusive = { dorwinion_trait_banner_breakthrough }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_company_of_winter_soft_attack_tooltip
				hidden_effect = {
					set_technology = {
						DOR_company_of_winter_soft_attack = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_breakthrough
		name = DOR_company_of_winter_breakthrough
		icon = GFX_generic_mio_trait_icon_breakthrough
		
		position = { x=1 y=2 }
		relative_position_id = dorwinion_trait_banner_initiative
		any_parent = { dorwinion_trait_banner_initiative }
		
		mutually_exclusive = { dorwinion_trait_banner_soft_attack }
		
		on_complete = {
			FROM = {
				custom_effect_tooltip = DOR_company_of_winter_breakthrough_tooltip
				hidden_effect = {
					set_technology = {
						DOR_company_of_winter_breakthrough = 1
						popup = no
					}
				}
			}
		}
	}
	trait = {
		token = dorwinion_trait_banner_xp_loss
		name = DOR_company_of_winter_xp_loss
		icon = GFX_generic_mio_trait_icon_scales
		
		position = { x=1 y=1 }
		relative_position_id = dorwinion_trait_banner_morale
		any_parent = { dorwinion_trait_banner_morale }
		
		on_complete = {
			custom_effect_tooltip = dorwinion_trait_banner_xp_loss_tooltip
			FROM = {
				custom_effect_tooltip = DOR_company_of_winter_xp_loss_tooltip
				hidden_effect = {
					set_technology = {
						DOR_company_of_winter_xp_loss = 1
						popup = no
					}
				}
			}
		}
	}
}
##############################################################################################################################
# DWARVEN PROSPECTORS
##############################################################################################################################
DOR_dwarven_prospectors_MIO = {
	name = dorwinion_dwarven_prospectors
	icon = GFX_idea_dorwinion_dwarven_prospectors

	allowed = {
		original_tag = DOR
		NOT = { has_country_flag = elected_winelord }
	}
	available = { FROM = { has_completed_focus = DOR_employ_their_expertise } }
	
	equipment_type {
		infantry_equipment
		infantry_armor
	}
	research_categories = {
		infantry_tech
	}
	tree_header_text = {
		text = mio_header_masonry
		x = 1
	}
	tree_header_text = {
		text = mio_header_weapons_and_armor
		x = 5
	}

	initial_trait = {
		name = mining_concern
		production_bonus = {
			production_resource_need_factor = -0.1
			production_resource_penalty_factor = -0.1
		}
	}
####################################################
#######################################################ECONOMIC
####################################################
####################################################
	trait = {
		token = generic_mio_trait_dwarven_mining
		name = generic_mio_trait_dwarven_mining
		icon = GFX_generic_mio_trait_icon_resources

		position = { x=1 y=0 }

		on_complete = { #10% resources
			FROM = {
				swap_ideas = {
					remove_idea = hidden_dwarven_prospectors_empty
					add_idea = hidden_dwarven_prospectors
				}
			}
		}
	}
	trait = {
		token = generic_mio_trait_stubborn_defense
		name = generic_mio_trait_stubborn_defense
		icon = GFX_generic_mio_trait_icon_defense

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_dwarven_mining
		all_parents = { generic_mio_trait_dwarven_mining }

		on_complete = { #10% fort effectiveness
			FROM = {
				swap_ideas = {
					remove_idea = hidden_dwarven_prospectors
					add_idea = hidden_dwarven_prospectors_fortification
				}
			}
		}
	}
	trait = {
		token = generic_mio_trait_dwarven_masonry
		name = generic_mio_trait_dwarven_masonry
		icon = GFX_generic_mio_trait_icon_political

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_stubborn_defense
		all_parents = { generic_mio_trait_stubborn_defense }

		on_complete = { #10% fort speed
			FROM = {
				swap_ideas = {
					remove_idea = hidden_dwarven_prospectors_fortification
					add_idea = hidden_dwarven_prospectors_fortification_construction
				}
			}
		}
	}
####################################################
#######################################################INFANTRY EQUIPMENT
####################################################
	trait = {
		token = generic_mio_trait_drum_pattern_sights
		name = generic_mio_trait_drum_pattern_sights
		icon = GFX_generic_mio_trait_icon_defense

		position = { x=4 y=0 }

		equipment_bonus = {
			defense = 0.035
		}
		organization_modifier = {
			military_industrial_organization_research_bonus = 0.025
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.025
		}
	}

	trait = {
		token = generic_mio_trait_reinforced_stocks
		name = generic_mio_trait_reinforced_stocks
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=2 y=0 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		equipment_bonus = {
			soft_attack = 0.025
			reliability = 0.03
		}
		organization_modifier = {
			military_industrial_organization_research_bonus = 0.025
		}
		production_bonus = {
			production_efficiency_cap_factor = 0.025
		}
	}

	trait = {
		token = generic_mio_trait_bolt_action
		name = generic_mio_trait_bolt_action
		icon = GFX_generic_mio_department_icon_infantry_line_efficiency

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_semi_auto }

		equipment_bonus = {
			soft_attack = -0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = 0.05
		}
	}

	trait = {
		token = generic_mio_trait_semi_auto
		name = generic_mio_trait_semi_auto
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_reinforced_stocks

		all_parents = { generic_mio_trait_reinforced_stocks }

		mutually_exclusive = { generic_mio_trait_bolt_action }

		equipment_bonus = {
			soft_attack = 0.03
			breakthrough = 0.03
		}

		production_bonus = {
			production_efficiency_gain_factor = -0.05
		}
	}

	trait = {
		token = generic_mio_trait_medium_machineguns
		name = generic_mio_trait_medium_machineguns
		icon = GFX_generic_mio_trait_icon_breakthrough

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_bolt_action

		any_parent = { generic_mio_trait_semi_auto generic_mio_trait_bolt_action }
		
		equipment_bonus = {
			breakthrough = 0.06
			build_cost_ic = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_advanced_barrel_forging
		name = generic_mio_trait_advanced_barrel_forging
		icon = GFX_generic_mio_trait_icon_efficiency_gain

		position = { x=1 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		any_parent = { generic_mio_trait_reinforced_stocks generic_mio_trait_drum_pattern_sights }

		production_bonus = {
			production_efficiency_gain_factor = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_mass_rifle_production
		name = generic_mio_trait_mass_rifle_production
		icon = GFX_generic_mio_department_icon_facilities

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_advanced_barrel_forging

		all_parents = { generic_mio_trait_advanced_barrel_forging }

		production_bonus = {
			production_efficiency_cap_factor = 0.03
			production_cost_factor = -0.03
		}

		organization_modifier = {
			military_industrial_organization_design_team_assign_cost = -0.3
		}
	}


	trait = {
		token = generic_mio_trait_quality_materials
		name = generic_mio_trait_quality_materials
		icon = GFX_generic_mio_trait_icon_reliability

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_drum_pattern_sights

		all_parents = { generic_mio_trait_drum_pattern_sights }

		equipment_bonus = {
			reliability = 0.05
		}

	}

	trait = {
		token = generic_mio_trait_improved_small_arms_bullet_design
		name = generic_mio_trait_improved_small_arms_bullet_design
		icon = GFX_generic_mio_trait_icon_soft_attack

		position = { x=-1 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }

		mutually_exclusive = { generic_mio_trait_armor_piercing_rounds }

		equipment_bonus = {
			soft_attack = 0.05
			breakthrough = 0.03
		}
	}

	trait = {
		token = generic_mio_trait_armor_piercing_rounds
		name = generic_mio_trait_armor_piercing_rounds
		icon = GFX_generic_mio_trait_icon_ap_attack

		position = { x=0 y=2 }
		relative_position_id = generic_mio_trait_quality_materials

		all_parents = { generic_mio_trait_quality_materials }
		
		mutually_exclusive = { generic_mio_trait_improved_small_arms_bullet_design }

		equipment_bonus = {
			ap_attack = 0.25
			hard_attack = 0.05
		}
	}
}